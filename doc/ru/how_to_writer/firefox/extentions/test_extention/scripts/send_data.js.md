Как использовать JavaScript для сбора данных со страницы и отправки на сервер
=========================================================================================

Описание
-------------------------
Этот JavaScript-код предназначен для сбора данных со страницы после ее полной загрузки и отправки этих данных на сервер. Он собирает заголовок страницы, URL и HTML-содержимое, формирует JSON-объект и отправляет его POST-запросом на указанный адрес.

Шаги выполнения
-------------------------
1.  **Создание обработчика события `onPageLoad`:**
    -   Определяется функция `onPageLoad()`, которая будет выполняться после полной загрузки страницы.
    -  Эта функция используется для сбора и отправки данных.
2.  **Сбор данных со страницы:**
    -   Внутри `onPageLoad()`:
         -  `document.title` получает заголовок текущей страницы.
        -  `window.location.href` получает URL текущей страницы.
       -   `document.body.innerHTML` получает HTML-содержимое элемента `<body>`.
3.  **Формирование объекта данных:**
    - Создается объект `data` в формате JSON, который содержит:
        -  `title`: заголовок страницы.
        -  `url`: URL страницы.
        - `body`: HTML-содержимое страницы.
4. **Отправка данных на сервер:**
   - Используется `fetch()` для отправки данных:
     -   POST запрос отправляется на адрес `http://127.0.0.1/hypotez.online/api/`.
     -  Устанавливается заголовок `'Content-Type': 'application/json'` для указания формата данных.
       - Данные отправляются в теле запроса в формате JSON с использованием `JSON.stringify(data)`.
5.  **Обработка ответа сервера:**
    -   Код обрабатывает ответ от сервера:
        -   При успешном ответе выводится сообщение "Data sent to server successfully" в консоль.
        -   В случае ошибки в консоль выводится сообщение об ошибке.
6. **Установка обработчика события загрузки страницы:**
   - `window.addEventListener('load', onPageLoad);` устанавливает прослушиватель события `load` на объект `window`.
   - Когда страница полностью загружена, выполняется функция `onPageLoad`.
7.  **Использование в проекте:**
    -  Код может быть вставлен в `contentScript.js` вашего расширения или в любой HTML файл.
    - После загрузки страницы скрипт будет выполняться, собирая данные и отправляя их на сервер.

Пример использования
-------------------------
.. code-block:: javascript

    // contentScript.js
    
    // Создаем обработчик события для загрузки страницы
    function onPageLoad() {
        // Собираем информацию о странице
        var title = document.title;
        var url = window.location.href;
        var body = document.body.innerHTML;
    
        // Формируем объект с данными для отправки
        var data = {
            title: title,
            url: url,
            body: body
        };
    
        // Отправляем данные на указанный адрес
        fetch('http://127.0.0.1/hypotez.online/api/', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
             body: JSON.stringify(data)
        })
           .then(response => {
                if (!response.ok) {
                   throw new Error('Network response was not ok');
                }
              return response.json();
          })
            .then(json => {
              console.log('Response:', json);
          })
          .catch(error => {
             console.error('Error:', error);
         });
    }
    
    // Добавляем обработчик события для загрузки страницы
    window.addEventListener('load', onPageLoad);
```