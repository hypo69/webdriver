# Модуль `src.suppliers.kualastyle.graber`

## Обзор

Модуль содержит класс `Graber`, который используется для сбора значений полей на странице товара веб-сайта `kualastyle.co.il`. Класс наследуется от `Graber` (`Grbr`) и переопределяет некоторые методы для нестандартной обработки полей, специфичных для данного поставщика. Также в модуле реализован механизм декораторов для выполнения предварительных действий перед отправкой запроса к веб-драйверу, таких как закрытие всплывающих окон.

## Подробней

Модуль предназначен для извлечения данных о товарах с сайта `kualastyle.co.il`. Он использует веб-драйвер для навигации по страницам товаров и извлечения необходимой информации. Основная задача модуля - предоставить унифицированный интерфейс для сбора данных, который может быть адаптирован к особенностям конкретного сайта поставщика.

## Классы

### `Graber`

**Описание**: Класс `Graber` предназначен для сбора данных о товарах с сайта `kualastyle.co.il`. Он наследуется от базового класса `Graber` (`Grbr`) и переопределяет некоторые методы для нестандартной обработки полей, специфичных для данного поставщика.

**Наследует**:

- `Graber` (`Grbr`): Базовый класс для сбора данных с веб-сайтов.

**Атрибуты**:

- `supplier_prefix` (str): Префикс поставщика, используемый для идентификации поставщика в системе.

**Методы**:

- `__init__(self, driver: Driver, lang_index: int)`: Инициализирует экземпляр класса `Graber`.

### `__init__`

```python
def __init__(self, driver: Driver, lang_index:int):
    """Инициализация класса сбора полей товара."""
    ...
```

**Назначение**: Инициализация экземпляра класса `Graber`. Устанавливает префикс поставщика и вызывает конструктор родительского класса.

**Параметры**:

- `driver` (Driver): Экземпляр веб-драйвера, используемый для взаимодействия с веб-сайтом.
- `lang_index` (int): Индекс языка, используемый для выбора локализации сайта.

**Возвращает**:

- `None`

**Как работает функция**:

1.  **Инициализация префикса поставщика**: Устанавливает атрибут `supplier_prefix` в значение `'kualastyle'`.
2.  **Вызов конструктора родительского класса**: Вызывает конструктор родительского класса `Graber` (`Grbr`) с передачей префикса поставщика, экземпляра веб-драйвера и индекса языка.
3.  **Установка глобальных настроек через Context**: Устанавливает `Context.locator_for_decorator` в `None`, что указывает на отсутствие необходимости выполнения каких-либо действий в декораторе `@close_pop_up`.

**Примеры**:

```python
from src.webdriver.driver import Driver
from src.webdriver.chrome import Chrome

# Создание экземпляра драйвера (пример с Chrome)
driver = Driver(Chrome)

# Создание экземпляра класса Graber
graber = Graber(driver, 0)
```

## Функции

### `close_pop_up` (Декоратор)

```python
# def close_pop_up(value: Any = None) -> Callable:
#     """Создает декоратор для закрытия всплывающих окон перед выполнением основной логики функции.
#
#     Args:
#         value (Any): Дополнительное значение для декоратора.
#
#     Returns:
#         Callable: Декоратор, оборачивающий функцию.
#     """
#     def decorator(func: Callable) -> Callable:
#         @wraps(func)
#         async def wrapper(*args, **kwargs):\n
#             try:
#                 # await Context.driver.execute_locator(Context.locator.close_pop_up)  # Await async pop-up close
#                 ...
#             except ExecuteLocatorException as e:
#                 logger.debug(f\'Ошибка выполнения локатора: {e}\')
#             return await func(*args, **kwargs)  # Await the main function
#         return wrapper
#     return decorator
```

**Назначение**: Создает декоратор для закрытия всплывающих окон перед выполнением основной логики функции.

**Параметры**:

- `value` (Any, optional): Дополнительное значение для декоратора. По умолчанию `None`.

**Возвращает**:

- `Callable`: Декоратор, оборачивающий функцию.

**Как работает функция**:

1.  **Создание декоратора**: Определяет функцию `decorator`, которая принимает функцию `func` в качестве аргумента и возвращает обертку `wrapper`.
2.  **Создание обертки**: Определяет асинхронную функцию `wrapper`, которая выполняет следующие действия:
    -   **Обработка исключений**: Закрывает всплывающее окно, если оно присутствует. Если возникает исключение `ExecuteLocatorException`, оно логируется.
    -   **Вызов основной функции**: Вызывает основную функцию `func` с переданными аргументами и возвращает результат.

## ASCII flowchart

```
close_pop_up
↓
decorator
↓
wrapper
↓
Try:
    Execute locator (Context.locator.close_pop_up)
Except ExecuteLocatorException:
    Log error
↓
Call main function
↓
Return result