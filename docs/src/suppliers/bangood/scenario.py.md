# Модуль: `src.suppliers.bangood.scenario`

## Обзор

Модуль предназначен для сбора информации о товарах с сайта banggood.co.il. Он включает в себя функциональность для извлечения списка категорий товаров и списка товаров в каждой категории, используя веб-драйвер. Модуль разработан для работы с уникальной структурой сайта banggood.co.il и может быть адаптирован для других поставщиков.

## Подробней

Этот модуль является частью системы для сбора и обработки данных о товарах из различных интернет-магазинов. Он специализируется на поставщике Banggood и включает в себя функции для навигации по сайту, извлечения данных о категориях и товарах, а также обработки полученной информации.

Модуль выполняет следующие основные задачи:

1.  **Сбор списка категорий**: Извлекает список категорий товаров с сайта поставщика. Это позволяет определить структуру сайта и получить доступ к товарам, сгруппированным по категориям.
2.  **Сбор списка товаров в категории**: Получает список товаров, представленных в определенной категории. Это позволяет получить ссылки на отдельные страницы товаров для дальнейшего анализа и обработки.
3.  **Обработка страниц товаров**: Передает управление в функцию `grab_product_page()`, которая отвечает за извлечение конкретных данных о товаре (наименование, описание, цена и т.д.) со страницы товара.

## Функции

### `get_list_products_in_category`

```python
def get_list_products_in_category (s) -> list[str, str, None]:
    """ Returns list of products urls from category page
    Если надо пролистстать - страницы категорий - листаю ??????

    Attrs:
        s - Supplier
    @returns
        list or one of products urls or None
    """
```

**Назначение**: Извлекает список URL товаров со страницы категории. Функция использует веб-драйвер для взаимодействия с сайтом и локаторы для поиска элементов, содержащих ссылки на товары.

**Параметры**:

*   `s` (Supplier): Объект поставщика, содержащий информацию о конфигурации веб-драйвера, локаторах и другие необходимые параметры.

**Возвращает**:

*   `list[str, str, None]`: Список URL товаров, найденных на странице категории. Если товары не найдены, возвращает `None`.

**Как работает функция**:

1.  **Инициализация**: Функция принимает объект поставщика `s`, содержащий необходимые параметры для работы с веб-драйвером и локаторами.
2.  **Получение веб-драйвера**: Из объекта поставщика извлекается объект веб-драйвера `d`.
3.  **Извлечение локаторов**: Из объекта поставщика извлекаются локаторы элементов страницы категории `l`.
4.  **Закрытие баннера**: Функция пытается закрыть рекламный баннер, используя локатор `s.locators['category']['close_banner']`.
5.  **Проверка наличия локаторов**: Проверяется, что локаторы элементов страницы категории были успешно извлечены. Если локаторы отсутствуют, функция логирует ошибку и завершает работу.
6.  **Прокрутка страницы**: Выполняется прокрутка страницы для загрузки всех элементов, содержащих ссылки на товары.
7.  **Извлечение ссылок на товары**: Используя локатор `l['product_links']`, функция пытается извлечь список элементов, содержащих ссылки на товары.
8.  **Обработка результата**: Если ссылки на товары не найдены, функция логирует предупреждение и завершает работу. Если найдена одна ссылка, она преобразуется в список для единообразия обработки.
9.  **Логирование количества найденных товаров**: Функция логирует информацию о количестве найденных ссылок на товары.
10. **Возврат результата**: Функция возвращает список URL товаров, найденных на странице категории.

**ASCII flowchart**:

```
Начало
    ↓
Получение веб-драйвера и локаторов (A)
    ↓
Закрытие баннера (B)
    ↓
Проверка наличия локаторов (C)
    ↓
Прокрутка страницы (D)
    ↓
Извлечение ссылок на товары (E)
    ↓
Обработка результата (F)
    ↓
Логирование количества товаров (G)
    ↓
Возврат списка URL товаров (H)
    ↓
Конец
```

Где:

*   `A` - Получение веб-драйвера и локаторов элементов страницы категории из объекта поставщика.
*   `B` - Попытка закрытия рекламного баннера, используя локатор.
*   `C` - Проверка наличия локаторов элементов страницы категории.
*   `D` - Прокрутка страницы для загрузки всех элементов.
*   `E` - Извлечение списка элементов, содержащих ссылки на товары, используя локатор.
*   `F` - Обработка результата извлечения ссылок на товары.
*   `G` - Логирование информации о количестве найденных ссылок на товары.
*   `H` - Возврат списка URL товаров, найденных на странице категории.

**Примеры**:

Пример вызова функции:

```python
from unittest.mock import MagicMock

# Mocking the supplier object
supplier_mock = MagicMock()
supplier_mock.driver.execute_locator.return_value = ['https://example.com/product1', 'https://example.com/product2']
supplier_mock.locators = {'category': {'product_links': 'test_locator'}, 'product': {'close_banner': 'close_banner_locator'}}

# Calling the function
product_list = get_list_products_in_category(supplier_mock)
print(product_list)
# Expected output: ['https://example.com/product1', 'https://example.com/product2']
```

### `get_list_categories_from_site`

```python
def get_list_categories_from_site(s):
    ...
```

**Назначение**: Эта функция предназначена для получения списка категорий товаров с сайта. В предоставленном коде реализации функции нет (`...`).