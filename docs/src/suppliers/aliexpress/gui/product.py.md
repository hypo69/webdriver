# Модуль для работы с редактором продуктов AliExpress (GUI)

## Обзор

Модуль предоставляет графический интерфейс (GUI) для редактирования информации о продуктах AliExpress. Он включает в себя функциональность для загрузки данных из JSON-файлов, отображения информации о продукте и подготовки продукта к дальнейшей обработке. Модуль использует библиотеку `PyQt6` для создания интерфейса пользователя.

## Подробнее

Этот модуль предназначен для создания удобного интерфейса для работы с данными о продуктах AliExpress. Он позволяет пользователям открывать JSON-файлы с информацией о продуктах, просматривать эту информацию в структурированном виде и подготавливать продукты к дальнейшей обработке с использованием класса `AliCampaignEditor`.

## Классы

### `ProductEditor`

**Описание**:
Виджет-редактор продуктов, предоставляющий интерфейс для загрузки, отображения и подготовки информации о продуктах.

**Наследует**:
- `QtWidgets.QWidget`: Базовый класс для всех виджетов в PyQt6.

**Атрибуты**:
- `data` (SimpleNamespace): Пространство имен для хранения данных о продукте, загруженных из JSON-файла. Изначально установлено в `None`.
- `language` (str): Язык, используемый в редакторе. По умолчанию установлен в `'EN'`.
- `currency` (str): Валюта, используемая в редакторе. По умолчанию установлена в `'USD'`.
- `file_path` (str): Путь к загруженному JSON-файлу. Изначально установлено в `None`.
- `editor` (AliCampaignEditor): Экземпляр редактора кампаний AliExpress, связанный с текущим продуктом.
- `main_app`: Ссылка на главный экземпляр приложения для доступа к глобальным ресурсам.

**Методы**:

- `__init__(self, parent=None, main_app=None)`
    ```python
    def __init__(self, parent=None, main_app=None):
        """ Инициализирует виджет ProductEditor 
        Args:
            parent (QWidget, optional): Родительский виджет. По умолчанию `None`.
            main_app (MainApp, optional): Экземпляр главного приложения. По умолчанию `None`.
        """
    ```

- `setup_ui(self)`
    ```python
    def setup_ui(self):
        """ Настраивает пользовательский интерфейс виджета """
    ```

- `setup_connections(self)`
    ```python
    def setup_connections(self):
        """ Устанавливает соединения между сигналами и слотами """
    ```

- `open_file(self)`
    ```python
    def open_file(self):
        """ Открывает диалоговое окно выбора файла для загрузки JSON-файла """
    ```

- `load_file(self, file_path)`
    ```python
    def load_file(self, file_path):
        """ Загружает JSON-файл """
    ```

- `create_widgets(self, data)`
    ```python
    def create_widgets(self, data):
        """ Создает виджеты на основе данных, загруженных из JSON-файла """
    ```

- `prepare_product_async(self)`
    ```python
    def prepare_product_async(self):
        """ Асинхронно подготавливает продукт """
    ```

### `__init__`
```python
def __init__(self, parent=None, main_app=None):
    """
    Инициализирует виджет `ProductEditor`.

    Args:
        parent (QWidget, optional): Родительский виджет. По умолчанию `None`.
        main_app (MainApp, optional): Экземпляр главного приложения. По умолчанию `None`.
    """
```

**Назначение**:
Инициализация виджета `ProductEditor`, установка родительского виджета и сохранение ссылки на главный экземпляр приложения.

**Параметры**:
- `parent` (QtWidgets.QWidget, optional): Родительский виджет. По умолчанию `None`.
- `main_app`: Ссылка на главный экземпляр приложения для доступа к глобальным ресурсам.

**Как работает функция**:
1. Вызывается конструктор родительского класса `QtWidgets.QWidget` для инициализации базовых свойств виджета.
2. Сохраняется ссылка на главный экземпляр приложения в атрибуте `self.main_app`.
3. Вызывается метод `setup_ui()` для настройки пользовательского интерфейса виджета.
4. Вызывается метод `setup_connections()` для установки соединений между сигналами и слотами.

**Примеры**:
```python
# Пример создания экземпляра класса ProductEditor
product_editor = ProductEditor(main_app=main_app_instance)
```

### `setup_ui`
```python
def setup_ui(self):
    """
    Настраивает пользовательский интерфейс виджета.
    """
```

**Назначение**:
Настройка пользовательского интерфейса виджета, включая установку заголовка окна, изменение размеров и добавление UI-компонентов.

**Как работает функция**:
1. Устанавливается заголовок окна виджета на "Product Editor".
2. Устанавливается размер окна виджета на 1800x800 пикселей.
3. Определяются компоненты пользовательского интерфейса:
   - Кнопка "Open JSON File" (QtWidgets.QPushButton) для открытия диалогового окна выбора файла.
   - Метка (QtWidgets.QLabel) для отображения имени выбранного файла. Изначально содержит текст "No file selected".
   - Кнопка "Prepare Product" (QtWidgets.QPushButton) для подготовки продукта.
4. Создается вертикальный макет (QtWidgets.QVBoxLayout) и в него добавляются созданные компоненты.
5. Устанавливается макет для виджета.

**Примеры**:
```python
# Пример вызова метода setup_ui
product_editor.setup_ui()
```

### `setup_connections`
```python
def setup_connections(self):
    """
    Устанавливает соединения между сигналами и слотами.
    """
```

**Назначение**:
Установка соединений между сигналами и слотами для обеспечения взаимодействия между компонентами пользовательского интерфейса.

**Как работает функция**:
Функция в текущей реализации пуста и не содержит логики для установки соединений.

**Примеры**:
```python
# Пример вызова метода setup_connections
product_editor.setup_connections()
```

### `open_file`
```python
def open_file(self):
    """
    Открывает диалоговое окно выбора файла для загрузки JSON-файла.
    """
```

**Назначение**:
Открытие диалогового окна для выбора JSON-файла и загрузка выбранного файла.

**Как работает функция**:
1. Открывается диалоговое окно выбора файла с использованием `QtWidgets.QFileDialog.getOpenFileName`.
2. Если файл не выбран (путь к файлу пустой), функция завершается.
3. Вызывается метод `load_file` для загрузки выбранного файла.

**Примеры**:
```python
# Пример вызова метода open_file
product_editor.open_file()
```

### `load_file`
```python
def load_file(self, file_path):
    """
    Загружает JSON-файл.

    Args:
        file_path (str): Путь к JSON-файлу.
    """
```

**Назначение**:
Загрузка JSON-файла, отображение имени файла и создание виджетов на основе загруженных данных.

**Параметры**:
- `file_path` (str): Путь к JSON-файлу.

**Как работает функция**:
1. Пытается загрузить данные из JSON-файла с использованием `j_loads_ns`.
2. Сохраняет путь к файлу в атрибуте `self.file_path`.
3. Обновляет текст метки `self.file_name_label` с именем файла.
4. Создает экземпляр `AliCampaignEditor`
5. Вызывает метод `create_widgets` для создания виджетов на основе загруженных данных.
6. В случае ошибки отображает сообщение об ошибке с использованием `QtWidgets.QMessageBox.critical`.

**Примеры**:
```python
# Пример вызова метода load_file
product_editor.load_file("path/to/file.json")
```

### `create_widgets`
```python
def create_widgets(self, data):
    """
    Создает виджеты на основе данных, загруженных из JSON-файла.

    Args:
        data (SimpleNamespace): Данные о продукте, загруженные из JSON-файла.
    """
```

**Назначение**:
Создание и отображение виджетов на основе данных о продукте, загруженных из JSON-файла.

**Параметры**:
- `data` (SimpleNamespace): Данные о продукте, загруженные из JSON-файла.

**Как работает функция**:
1. Получает макет виджета.
2. Удаляет все предыдущие виджеты из макета, кроме кнопок "Open JSON File", "Prepare Product" и метки имени файла.
3. Создает метку для отображения заголовка продукта (`data.title`) и добавляет ее в макет.
4. Создает метку для отображения деталей продукта (`data.details`) и добавляет ее в макет.

**Примеры**:
```python
# Пример вызова метода create_widgets
product_editor.create_widgets(data)
```

### `prepare_product_async`
```python
def prepare_product_async(self):
    """
    Асинхронно подготавливает продукт.
    """
```

**Назначение**:
Асинхронная подготовка продукта с использованием `AliCampaignEditor`.

**Как работает функция**:
1. Проверяет, инициализирован ли `self.editor`
2. Вызывает метод `prepare_product` из `AliCampaignEditor` для подготовки продукта.
3. В случае успеха отображает сообщение об успехе с использованием `QtWidgets.QMessageBox.information`.
4. В случае ошибки отображает сообщение об ошибке с использованием `QtWidgets.QMessageBox.critical`.

**Примеры**:
```python
# Пример вызова метода prepare_product_async
await product_editor.prepare_product_async()
```
```

### Внутренние функции: 
В данном классе нет внутренних функций

## Функции

В данном модуле нет отдельных функций, только методы класса `ProductEditor`.