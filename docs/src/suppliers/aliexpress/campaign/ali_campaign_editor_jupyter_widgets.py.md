# Модуль: `src.suppliers.aliexpress.campaign.ali_campaign_editor_jupyter_widgets.py`

## Обзор

Модуль содержит класс `JupyterCampaignEditorWidgets`, предназначенный для создания и управления виджетами Jupyter для редактирования кампаний AliExpress. Он предоставляет интерфейс для выбора кампаний, категорий, языков и выполнения действий, таких как инициализация редактора, сохранение кампаний и отображение продуктов.

## Подробнее

Этот модуль предназначен для использования в Jupyter Notebooks и предоставляет интерактивный интерфейс для работы с кампаниями AliExpress. Он использует библиотеку `ipywidgets` для создания виджетов и взаимодействует с классом `AliCampaignEditor` для выполнения операций с кампаниями.

## Классы

### `JupyterCampaignEditorWidgets`

**Описание**: Класс `JupyterCampaignEditorWidgets` предоставляет набор виджетов для взаимодействия с редактором кампаний AliExpress.

**Принцип работы**: Класс инициализирует виджеты, такие как выпадающие списки для выбора кампании, категории и языка, а также кнопки для выполнения различных действий. Он также устанавливает обработчики событий для этих виджетов, чтобы обеспечить динамическое обновление интерфейса и взаимодействие с редактором кампаний.

**Атрибуты**:
- `language` (str): Выбранный язык кампании.
- `currency` (str): Выбранная валюта кампании.
- `campaign_name` (str): Выбранное имя кампании.
- `category_name` (str): Выбранное имя категории.
- `category` (SimpleNamespace): Объект, представляющий выбранную категорию.
- `campaign_editor` (AliCampaignEditor): Экземпляр редактора кампаний AliExpress.
- `products` (list[SimpleNamespace]): Список продуктов, связанных с выбранной категорией.
- `campaigns_directory` (str): Путь к директории с кампаниями.

**Методы**:

#### `__init__`
```python
    def __init__(self):
        """Инициализирует виджеты и настраивает редактор кампаний.

        Настраивает виджеты для выбора кампаний, категорий и языков. 
        Также устанавливает значения по умолчанию и обратные вызовы для виджетов.
        """
```

**Как работает функция**:
1. Определяет путь к директории с кампаниями AliExpress на Google Drive.
2. Проверяет, существует ли директория с кампаниями. Если нет, выбрасывает исключение `FileNotFoundError`.
3. Создает виджеты `Dropdown` для выбора имени кампании, категории и языка/валюты.
4. Создает виджеты `Button` для инициализации редактора кампании, сохранения кампании, отображения продуктов и открытия Google Spreadsheet.
5. Устанавливает обратные вызовы для виджетов.
6. Инициализирует редактор кампании со значениями по умолчанию.

**Блок схема**:
```
A [Определение пути к директории кампаний]
|
B [Проверка существования директории]
|
C [Создание Dropdown виджетов для кампании, категории, языка]
|
D [Создание Button виджетов для инициализации, сохранения, отображения продуктов, открытия spreadsheet]
|
E [Установка обратных вызовов для виджетов]
|
F [Инициализация редактора кампании со значениями по умолчанию]
```

#### `initialize_campaign_editor`
```python
    def initialize_campaign_editor(self, _):
        """Инициализирует редактор кампаний.

        Args:
            _: Неиспользуемый аргумент, необходимый для обратного вызова кнопки.

        Настраивает редактор кампаний на основе выбранной кампании и категории.
        """
```

**Как работает функция**:
1. Получает выбранные значения из выпадающих списков для имени кампании, категории и языка/валюты.
2. Если имя кампании выбрано, обновляет выпадающий список категорий на основе выбранной кампании.
3. Создает экземпляр класса `AliCampaignEditor` с выбранными параметрами.
4. Если категория выбрана, получает объект категории и список продуктов для этой категории.
5. Если имя кампании не выбрано, логирует предупреждение.

**Блок схема**:
```
A [Получение выбранных значений из выпадающих списков]
|
B [Проверка, выбрано ли имя кампании]
|
C [Обновление выпадающего списка категорий (если имя кампании выбрано)]
|
D [Создание экземпляра AliCampaignEditor (если имя кампании выбрано)]
|
E [Получение объекта категории и списка продуктов (если категория выбрана)]
|
F [Логирование предупреждения (если имя кампании не выбрано)]
```

#### `update_category_dropdown`
```python
    def update_category_dropdown(self, campaign_name: str):
        """Обновляет выпадающий список категорий на основе выбранной кампании.

        Args:
            campaign_name (str): Имя кампании.

        Example:
            >>> self.update_category_dropdown("SummerSale")
        """
```
**Как работает функция**:
1. Формирует путь к директории категорий для выбранной кампании.
2. Получает список имен директорий (категорий) в этой директории.
3. Обновляет опции выпадающего списка категорий полученным списком.

**Блок схема**:
```
A [Формирование пути к директории категорий]
|
B [Получение списка имен директорий (категорий)]
|
C [Обновление опций выпадающего списка категорий]
```

#### `on_campaign_name_change`
```python
    def on_campaign_name_change(self, change: dict[str, str]):
        """Обрабатывает изменения в выпадающем списке имен кампаний.

        Args:
            change (dict[str, str]): Словарь изменений, содержащий новое значение.

        Example:
            >>> self.on_campaign_name_change({'new': 'SummerSale'})
        """
```
**Как работает функция**:
1. Получает новое имя кампании из словаря изменений.
2. Обновляет выпадающий список категорий на основе выбранной кампании.
3. Повторно инициализирует редактор кампании с новым именем кампании.

**Блок схема**:
```
A [Получение нового имени кампании]
|
B [Обновление выпадающего списка категорий]
|
C [Повторная инициализация редактора кампании]
```

#### `on_category_change`
```python
    def on_category_change(self, change: dict[str, str]):
        """Обрабатывает изменения в выпадающем списке категорий.

        Args:
            change (dict[str, str]): Словарь изменений, содержащий новое значение.

        Example:
            >>> self.on_category_change({'new': 'Electronics'})
        """
```

**Как работает функция**:
1. Получает новое имя категории из словаря изменений.
2. Повторно инициализирует редактор кампании с новой категорией.

**Блок схема**:
```
A [Получение нового имени категории]
|
B [Повторная инициализация редактора кампании]
```

#### `on_language_change`
```python
    def on_language_change(self, change: dict[str, str]):
        """Обрабатывает изменения в выпадающем списке языков.

        Args:
            change (dict[str, str]): Словарь изменений, содержащий новое значение.

        Example:
            >>> self.on_language_change({'new': 'EN USD'})
        """
```

**Как работает функция**:
1. Получает новый язык и валюту из словаря изменений.
2. Повторно инициализирует редактор кампании с новым языком и валютой.

**Блок схема**:
```
A [Получение нового языка и валюты]
|
B [Повторная инициализация редактора кампании]
```

#### `save_campaign`
```python
    def save_campaign(self, _):
        """Сохраняет кампанию и ее категории.

        Args:
            _: Неиспользуемый аргумент, необходимый для обратного вызова кнопки.

        Example:
            >>> self.save_campaign(None)
        """
```

**Как работает функция**:
1. Получает значения из выпадающих списков для имени кампании, категории и языка/валюты.
2. Если имя кампании и язык выбраны, создает экземпляр класса `AliCampaignEditor` с выбранными параметрами.
3. Пытается сохранить категории из worksheet с помощью метода `save_categories_from_worksheet`.
4. Если происходит ошибка при сохранении кампании, логирует ошибку.
5. Если имя кампании или язык не выбраны, логирует предупреждение.

**Блок схема**:
```
A [Получение значений из выпадающих списков]
|
B [Проверка, выбраны ли имя кампании и язык]
|
C [Создание экземпляра AliCampaignEditor (если имя кампании и язык выбраны)]
|
D [Попытка сохранения категорий из worksheet]
|
E [Логирование ошибки (если произошла ошибка при сохранении)]
|
F [Логирование предупреждения (если имя кампании или язык не выбраны)]
```

#### `show_products`
```python
    def show_products(self, _):
        """Отображает продукты в выбранной категории.

        Args:
            _: Неиспользуемый аргумент, необходимый для обратного вызова кнопки.

        Example:
            >>> self.show_products(None)
        """
```

**Как работает функция**:
1. Получает имя кампании и имя категории из выпадающих списков.
2. Пытается создать экземпляр класса `AliCampaignEditor` с выбранными параметрами.
3. Устанавливает worksheet продуктов с помощью метода `set_products_worksheet`.
4. Если происходит ошибка при отображении продуктов, логирует ошибку.

**Блок схема**:
```
A [Получение имени кампании и имени категории]
|
B [Попытка создания экземпляра AliCampaignEditor]
|
C [Установка worksheet продуктов]
|
D [Логирование ошибки (если произошла ошибка при отображении продуктов)]
```

#### `open_spreadsheet`
```python
    def open_spreadsheet(self, _):
        """Открывает Google Spreadsheet в браузере.

        Args:
            _: Неиспользуемый аргумент, необходимый для обратного вызова кнопки.

        Example:
            >>> self.open_spreadsheet(None)
        """
```

**Как работает функция**:
1. Проверяет, инициализирован ли редактор кампании.
2. Если редактор кампании инициализирован, формирует URL для Google Spreadsheet и открывает его в браузере.
3. Если редактор кампании не инициализирован, выводит сообщение об этом.

**Блок схема**:
```
A [Проверка, инициализирован ли редактор кампании]
|
B [Формирование URL и открытие spreadsheet в браузере (если редактор инициализирован)]
|
C [Вывод сообщения (если редактор не инициализирован)]
```

#### `setup_callbacks`
```python
    def setup_callbacks(self):
        """Устанавливает обратные вызовы для виджетов."""
```

**Как работает функция**:
1. Устанавливает обратные вызовы для выпадающих списков имени кампании, категории и языка.
2. Устанавливает обратные вызовы для кнопок инициализации, сохранения, отображения продуктов и открытия spreadsheet.

**Блок схема**:
```
A [Установка обратных вызовов для выпадающих списков]
|
B [Установка обратных вызовов для кнопок]
```

#### `display_widgets`
```python
    def display_widgets(self):
        """Отображает виджеты для взаимодействия в Jupyter notebook.

        Инициализирует редактор кампаний автоматически с первой выбранной кампанией.

        Example:
            >>> self.display_widgets()
        """
```

**Как работает функция**:
1. Отображает виджеты выпадающих списков и кнопок в Jupyter notebook.
2. Инициализирует редактор кампании с первой выбранной кампанией.

**Блок схема**:
```
A [Отображение виджетов в Jupyter notebook]
|
B [Инициализация редактора кампании с первой выбранной кампанией]
```
## Функции

В данном модуле нет отдельных функций, не относящихся к классам.