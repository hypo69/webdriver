# Модуль src.___beeryakov

## Обзор

Модуль предназначен для парсинга данных с сайта ksp.co.il и записи их в Google Sheets. Он использует библиотеки `gs`, `logger`, `webdriver_driver`, `GSpreadsheet` и `GWorksheet` для взаимодействия с сайтом, управления браузером и работой с Google Sheets соответственно.

## Подробней

Этот модуль является частью проекта `hypotez` и отвечает за автоматизированный сбор данных о товарах и их наличии на сайте ksp.co.il. Собранные данные затем структурированно записываются в Google Sheets для дальнейшего анализа и использования. Он извлекает информацию о категориях товаров, брендах и их количестве, а затем сохраняет её в таблицу Google Sheets.

## Функции

### `run`

```python
def run():
    """
    Старт парсера
    """
```

**Описание**: Функция `run` является основной точкой входа для запуска парсера.

**Как работает функция**:
1.  Определяет ID Google Sheets, с которым будет работать.
2.  Устанавливает корневой URL сайта ksp.co.il.
3.  Получает словарь категорий товаров (worlds_dic) с помощью функции `ksp.get_worlds()`.
4.  Инициализирует объект `GSpreadsheet` для работы с Google Sheets.
5.  Для каждой категории товаров:

    *   Создает или получает рабочий лист (worksheet) в Google Sheets.
    *   Записывает заголовок рабочего листа.
    *   Получает список подкатегорий товаров (subs) с помощью функции `ksp.get_subs_from_world()`.
    *   Для каждой подкатегории:

        *   Записывает название категории в рабочий лист.
        *   Получает список брендов и их количества с помощью функции `ksp.get_all_brands_list()`.
        *   Записывает информацию о брендах и их количестве в рабочий лист.
6.  Выводит сообщение об окончании обработки категории.

**Параметры**:
-   Нет

**Возвращает**:
-   Нет

**Вызывает исключения**:
-   `WebDriverException`: Если возникают проблемы с управлением браузером.
-   Любые исключения, которые могут возникнуть при работе с Google Sheets API или при парсинге сайта ksp.co.il.

**Примеры**:

```python
run()
```

### `get_all_spreadsheets`

```python
def get_all_spreadsheets():
    gspreadsheets = gsh.get_all_spreadsheets_for_current_account()
    ...
```

**Описание**: Функция `get_all_spreadsheets` получает список всех Google Sheets, доступных для текущей учетной записи.

**Как работает функция**:
1.  Использует функцию `gsh.get_all_spreadsheets_for_current_account()` для получения списка Google Sheets.

**Параметры**:
-   Нет

**Возвращает**:
-   `gspreadsheets`: Cписок всех Google Sheets.

**Вызывает исключения**:
-   Любые исключения, которые могут возникнуть при работе с Google Sheets API.

**Примеры**:

```python
get_all_spreadsheets()
```