# ИНСТРУКЦИЯ

Предоставленный ниже код - часть проекта `hypotez`. Задача: создать документацию для разработчика в формате `Markdown` для каждого входного Python-файла.
Документация должна соответствовать следующим требованиям:

1. **Формат документации**:
   - Используй стандарт `Markdown (.md)`.
   - Каждый файл должен начинаться с заголовка и краткого описания его содержимого.

   Примеры документации: Пример загаоловка файла модуля:

        """
        Модуль для работы с ассистентом программиста
        =================================================

        Модуль содержит класс :class:`CodeAssistant`, который используется для взаимодействия с различными AI-моделями
        (например, Google Gemini и OpenAI) и выполнения задач обработки кода.

        Пример использования
        ----------------------

        >>>assistant = CodeAssistant(role='code_checker', lang='ru', model=['gemini'])\
        >>>assistant.process_files()\
        """

   - Для всех классов и функций используйте следующий формат комментариев:
     ```python
     def function(param: str, param1: Optional[str | dict | str] = None) -> dict | None:
         """ Функция выполняет некоторое действия... <Тут Ты пишешь что именно делает функция>
         Args:
             param (str): Описание параметра `param`.
             param1 (Optional[str | dict | str], optional): Описание параметра `param1`. По умолчанию `None`.

         Returns:
             dict | None: Описание возвращаемого значения. Возвращает словарь или `None`.

         Raises:
             SomeError: Описание ситуации, в которой возникает исключение `SomeError`.
            ...
            <Выводить тело функции НЕ НАДО. Только docstring>
         """
         def inner_function():
            """ Внутрняя функция Функция выполняет некоторое действия... <Тут Ты пишешь что именно делает функция>
                Args:
                    param (str): Описание параметра `param`.
                    param1 (Optional[str | dict | str], optional): Описание параметра `param1`. По умолчанию `None`.

                Returns:
                    dict | None: Описание возвращаемого значения. Возвращает словарь или `None`.

                Raises:
                    SomeError: Описание ситуации, в которой возникает исключение `SomeError`.

                ...
                    <Выводить тело функции НЕ НАДО. Только docstring>

                """
     ```
     - Все комментарии в фунцкии и docstring должны быть на русском языке в формате UTF-8
     - Если внутри рассматривемой функции есть внутренние функции - рассматривай подробно каждую из них по отдельности
     
   - Используй `ex` вместо `e` в блоках обработки исключений.
   - Для логгирования используй `logger` из моего модуля `src.logger`. Например:
     ```python
     from src.logger import logger
     logger.info('Some information message')
     ...
     except SomeError as ex:\
         logger.error('Some error message', ex, exc_info = True), где ошибка передается вторым аргументом. exc_info определает надо ли выводить служебную информацию.
     ```
   - Все комментарии и docstring должны быть на русском языке в формате UTF-8. Если в коде docsting на английском - сделай перевеод на русский

2. **Содержание (TOC)**:\
   - В начале каждого файла документации добавь раздел с оглавлением и ссылками на функции и методы внутри кода
   - Структура оглавления должна включать ссылки на все основные разделы документации модуля.

3. **Форматирование документации**:
   - Используй синтаксис Markdown для всех заголовков, списков и ссылок.
   - Для документирования классов, функций и методов включай структурированные разделы с описаниями, деталями параметров, возвращаемых значений и вызываемых исключений. Пример:

     ## Функции

     ### `function_name`

     **Назначение**: Назначение функции.

     **Как работает функция**:
     <Подробно объясни назначиение функции. Сдеалай подробное описание того, какие действия преобразования происходит в теле функции>

     Внутри функции происхоят следующие действия и преобразования:
     A
     |
     -- C
     |
     D - E
     |
     F

     Где `A,B,C,D,E,F` внутренние логические блоки функции

     Если внутри функции есть внутренние фуйнкции - рассмотри их по отдельности каждую

     **Параметры**:
     - `param` (str): Описание параметра `param`.
     - `param1` (Optional[str | dict | str], optional): Описание параметра `param1`. По умолчанию `None`.

     **Возвращает**:
     - `dict | None`: Описание возвращаемого значения.

     **Вызывает исключения**:
     - `SomeError`: Описание ситуации, в которой возникает исключение `SomeError`.
     
4. **Заголовки разделов**:
   - Используйте заголовки первого уровня (`#`), второго уровня (`##`), третьего уровня (`###`) и четвёртого уровня (`####`) последовательно на протяжении всего файла.

5. **Пример файла**:

   # Название модуля

   ## Обзор

   Краткое описание назначения модуля.

   ## Подорбней

   Более подробное описание. Объясни как и зачем используется данный код в проекте.
   Анализируй предоставленный тебе ранее код

   ## Классы

   ### `ClassName`

   **Описание**: Описание класса.

    **Как работает класс**:
        Объясни  работу класса. Если класс сложный сдеалай подорбный разбор кода
   Сделай документацию для КАЖДОЙ функции или метода. Объясни назначение каждой переменной.
   - Все комментарии и docstring должны быть на русском языке в формате UTF-8. Если в оригинальном коде текст напюисан на английском - переводи его на русский

   **Методы**: # если есть методы
   - `method_name`: Краткое описание метода.
   - `method_name`: Краткое описание метода.
   **Параметры**: # если есть параметры
   - `param` (str): Описание параметра `param`.
   - `param1` (Optional[str | dict | str], optional): Описание параметра `param1`. По умолчанию `None`.
   **Примеры**
   - Примеры определения класса и работы с классом

   ## Функции

   ### `function_name`

   ```python
   def my_func(param1:str, param2:Optional[int] = 0) -> bool:
       """ Функция выполняет некоторое действия... <Тут Ты пишешь что именно делает функция>
       Args:
           param1 (str): Описание параметра `param1`.
           param2 (Optional[int], optional): Описание параметра `param2`. По умолчанию 0.
       Returns:
           bool: Описание возвращаемого значения. Возвращает `True` или `False`.

        Raises:
             Ошибка выполнение

        Example:
            Примеры вызовов со всем спектром параметров. которы можно передать в функцию

       """
       - Не выводи тело функции. только документацию и примеры вызова функции;
       - Все комментарии и docstring должны быть на русском языке в формате UTF-8
   ```

    **Как работает функция**:
        Дай описание работы функции. Если функция сложная сдеалай подорбный разбор кода
   Сделай документацию для КАЖДОЙ функции или метода. Объясни назначение каждой переменной

   **Методы**: # если есть методы
   - `method_name`: Более подробное описание метода.
   - `method_name`: Более подробное описание метода.****

   **Параметры**: # если есть параметры
   - `param` (str): Более подробное Описание параметра `param`.
   - `param1` (Optional[str | dict | str], optional): Более подробное Описание параметра `param1`. По умолчанию `None`.

   **Возвращает**: # если есть возвращаемое значение
   - `dict | None`: Более подробное Описание возвращаемого значения.

   **Вызывает исключения**: # если есть исключения
   - `SomeError`: Более подробное Описание ситуации, в которой возникает исключение `SomeError`.

   **Примеры**: # Все возможные варианты примеров вызова функции с разными параметрами

   -------------------------------------------------------------------------------------
   

## Твое поведение при анализе кода:
- внутри кода ты можешь встретить выражение между `<` `>`. Например: <инструкция для модели gemini:Загрузка описаний продуктов в PrestaShop.>, <далее, если есть>. Это заготовки, куда ты вставляешь релевантное значение
- всегда смотри системную инструкцию для обработки кода проекта `hypotez`;
- анализируй расположение файла в проекте. Это поможет понять его назначение и взаимосвязь с другими файлами. Расположение файла ты найдешь в самой превой строке кода, начинающейся с `## \file /...`;
- запоминай предоставленный код и анализируй его связь с другими частями проекта;
- В этой инструкции не надо предлагать улучшение кода. Четко следуй пункту 5. **Пример файла** при составлении ответа

# КОНЕЦ ИНСТРУКЦИИ
```

# Документация для модуля тестирования `pytest_en.md`

## Обзор

Этот файл содержит инструкции и примеры для инженеров QA по написанию тестов для Python-модулей с использованием библиотеки `pytest`. Он охватывает основные функции и методы модуля, проверяет их корректное поведение в различных сценариях, включая крайние случаи, и обеспечивает надлежащую обработку ошибок.

## Содержание

- [Обзор](#обзор)
- [Подробней](#подробней)
- [Как писать тесты](#как-писать-тесты)
- [Примеры тестов](#примеры-тестов)
- [Заключение](#заключение)

## Подробней

Этот документ предназначен для предоставления подробных инструкций и рекомендаций по созданию эффективных и надежных тестов для Python-кода. Он описывает общий подход к написанию тестов, подготовке тестовых случаев, обработке ошибок, изоляции тестов и структуре тестов.

## Как писать тесты

### Анализ функциональности

Необходимо тщательно рассмотреть функции и методы, доступные в модуле. Определить их входные данные, ожидаемые выходные данные и возможные случаи ошибок. Разделить тесты на основные сценарии, крайние случаи и обработку исключений.

### Подготовка тестовых случаев

Для каждой функции или метода необходимо написать тестовые случаи, проверяющие функции с различными типами данных, где это применимо, такими как строки, списки, словари или пустые значения. Рассмотреть крайние случаи, такие как пустой ввод, несуществующие пути или недопустимые значения.

### Обработка ошибок

Необходимо моделировать сценарии, в которых могут возникать исключения, и проверять, что исключения обрабатываются и регистрируются надлежащим образом. Использовать `pytest.raises` для тестирования обработки исключений.

### Изоляция тестов

Использовать моки для замены реальных операций, где это возможно. Например, использовать моки вместо фактических взаимодействий с файловой системой или базами данных. Убедиться, что каждый тест не зависит от других и не полагается на внешнюю среду.

### Структура тестов

Использовать четкие и описательные имена для тестовых функций, отражающие их назначение. Организовать тестовый код для удобочитаемости и структуры. Использовать фикстуры `pytest` для настройки данных при необходимости.

## Примеры тестов

### `test_save_data_to_file`

```python
import pytest
from unittest.mock import patch, mock_open

@patch('module_name.Path.open', new_callable=mock_open)
@patch('module_name.Path.mkdir')
@patch('module_name.logger')
def test_save_data_to_file(mock_logger, mock_mkdir, mock_file_open):
    """Test saving data to a file."""
    file_path = '/path/to/your/file.txt'
    data = 'Sample text'

    # Test saving a string
    result = save_data_to_file(data, file_path)
    mock_mkdir.assert_called_once_with(parents=True, exist_ok=True)
    mock_file_open.assert_called_once_with('w')
    mock_file_open().write.assert_called_once_with(data)
    assert result is True

    # Test exception handling
    mock_file_open.side_effect = Exception('Mocked exception')
    result = save_data_to_file(data, file_path)
    mock_logger.error.assert_called_once()
    assert result is False
```

**Как работает функция**:

Эта функция тестирует сохранение данных в файл, используя моки для изоляции от реальной файловой системы. Она проверяет как успешное сохранение данных, так и обработку исключений.

Внутри функции происходят следующие действия и преобразования:
A
|
-- B
|
C - D
|
E

Где:
- `A`: Подготовка моков для `Path.open`, `Path.mkdir` и `logger`.
- `B`: Проверка успешного сохранения строки в файл.
- `C`: Моделирование исключения при открытии файла.
- `D`: Проверка обработки исключения и логирования ошибки.
- `E`: Проверка возвращаемого значения при возникновении исключения.

**Параметры**:

- `mock_logger`: Мок для модуля логирования.
- `mock_mkdir`: Мок для создания директорий.
- `mock_file_open`: Мок для открытия файла.

**Возвращает**:

- Нет явного возврата, функция проверяет утверждения (assert) для подтверждения правильности работы.

**Вызывает исключения**:

- Не моделирует конкретные исключения, но проверяет, что при возникновении исключения в процессе записи в файл, ошибка логируется.

## Заключение

Этот общий подход может быть применен к тестированию любого модуля, независимо от его функциональности. Убедитесь, что ваши тесты охватывают основные сценарии, крайние случаи и надлежащую обработку ошибок, сохраняя их изолированными и независимыми.