# Модуль конфигурации pytest для тестов tiny_troupe
=================================================

Модуль содержит настройки для pytest, позволяющие управлять использованием кэша API и запуском примеров во время тестирования.

## Обзор

Этот модуль предназначен для настройки параметров тестирования, таких как обновление кэша API, использование кэша и запуск примеров, что позволяет адаптировать процесс тестирования к различным потребностям и условиям. Он определяет глобальные опции тестирования и функции для добавления и обработки этих опций с помощью pytest.

## Подробнее

Этот модуль предоставляет глобальные переменные для управления поведением тестов, такие как `refresh_cache`, `use_cache` и `test_examples`. Он также включает функции `pytest_addoption` и `pytest_generate_tests`, которые позволяют настраивать параметры тестирования через командную строку и передавать их в тестовые функции. Это позволяет разработчикам гибко управлять процессом тестирования, например, при необходимости обновить кэш API для получения актуальных данных или пропустить запуск примеров для сокращения времени тестирования.

## Функции

### `pytest_addoption`

```python
def pytest_addoption(parser):
    """Добавляет опции командной строки для управления поведением тестов.

    Args:
        parser: Объект парсера опций pytest.

    Returns:
        None

    """
```

**Назначение**: Добавляет опции командной строки для управления поведением тестов, такие как обновление кэша, использование кэша и запуск примеров.

**Параметры**:
- `parser`: Объект парсера опций pytest, используемый для добавления опций командной строки.

**Возвращает**:
- `None`

**Как работает функция**:

1. Функция `pytest_addoption` принимает объект `parser` от pytest, который используется для добавления новых опций командной строки.
2.  Добавляет три опции командной строки:
    - `--refresh_cache`: Если указана, принудительно обновляет кэш API для тестов.
    - `--use_cache`: Если указана, использует кэш API для тестов, чтобы уменьшить количество вызовов API.
    - `--test_examples`: Если указана, запускает все примеры, чтобы убедиться, что они все еще работают (может значительно увеличить время тестирования).

```
    Добавление опций командной строки
    │
    └── Добавление опции "--refresh_cache" для обновления кэша API
    │
    └── Добавление опции "--use_cache" для использования кэша API
    │
    └── Добавление опции "--test_examples" для запуска примеров
```

**Примеры**:

Запуск тестов с обновлением кэша:
```bash
pytest --refresh_cache
```

Запуск тестов с использованием кэша:
```bash
pytest --use_cache
```

Запуск тестов с запуском примеров:
```bash
pytest --test_examples
```

### `pytest_generate_tests`

```python
def pytest_generate_tests(metafunc):
    """Обрабатывает опции командной строки и передает их в тестовые функции.

    Args:
        metafunc: Объект metafunc pytest, содержащий информацию о тестовой функции.

    Returns:
        None

    """
```

**Назначение**: Обрабатывает опции командной строки, полученные от pytest, и передает их в тестовые функции. Также выводит информацию о текущих настройках теста.

**Параметры**:
- `metafunc`: Объект `metafunc` pytest, содержащий информацию о тестовой функции.

**Возвращает**:
- `None`

**Как работает функция**:

1. Функция `pytest_generate_tests` принимает объект `metafunc` от pytest, который содержит информацию о текущей тестовой функции.
2.  Получает значения опций командной строки `--refresh_cache`, `--use_cache` и `--test_examples` с использованием `metafunc.config.getoption()`.
3.  Сохраняет полученные значения в глобальные переменные `refresh_cache`, `use_cache` и `test_examples`, чтобы они были доступны в других частях кода.
4.  Выводит информацию о текущих настройках теста (имя тестового случая, значения `refresh_cache`, `use_cache` и `test_examples`) в консоль для пользователя.

```
    Получение опций командной строки
    │
    └── Получение значения "--refresh_cache"
    │
    └── Получение значения "--use_cache"
    │
    └── Получение значения "--test_examples"
    │
    └── Вывод информации о настройках теста
```

**Примеры**:

В коде тестовой функции можно использовать глобальные переменные для определения поведения:
```python
def test_something():
    if refresh_cache:
        # Обновить кэш перед выполнением теста
        pass
    if use_cache:
        # Использовать кэш для выполнения теста
        pass
    if test_examples:
        # Запустить примеры в рамках теста
        pass