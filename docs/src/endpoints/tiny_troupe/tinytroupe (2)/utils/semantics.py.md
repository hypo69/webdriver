# Модуль semantics.py

## Обзор

Модуль `semantics.py` содержит функции, связанные с семантическим анализом текста. Он включает функции для перефразирования текста на основе заданных правил и для реструктуризации описания событий в формате "наблюдение против ожидания".
Функции используют декоратор `@llm()`, который, вероятно, отвечает за обработку запросов к языковой модели.

## Подробнее

Модуль предоставляет инструменты для изменения и анализа текста с использованием семантических правил и ожиданий.
Это может быть полезно для изменения поведения системы, анализа текста и генерации ответов на основе заданных правил.

## Функции

### `rephrase`

```python
@llm()
def rephrase(observation: str, rule: str) -> str:
    """
    Перефразирует или полностью изменяет наблюдение в соответствии с заданным правилом.

    Args:
        observation (str): Наблюдение, которое нужно перефразировать или изменить. Это может быть описание события или факта.
        rule (str): Правило, определяющее, как должно быть изменено наблюдение.

    Returns:
        str: Перефразированное или измененное наблюдение.
    """
```

**Как работает функция**:

Функция `rephrase` предназначена для изменения входного текста (`observation`) в соответствии с заданным правилом (`rule`).
Декоратор `@llm()` предполагает, что фактическая обработка выполняется языковой моделью,
которой передаются входные данные.
Функция может использоваться для изменения тональности текста, адаптации к определенному стилю или контексту, или для исправления неточностей.

```ascii
Наблюдение и правило
     ↓
Языковая модель (LLM)
     ↓
Перефразированное наблюдение
```

**Примеры**:

```python
# Пример 1: Изменение тональности
observation = "Сегодня мне грустно."
rule = "Я всегда счастлив, и депрессия мне неизвестна."
rephrased_observation = rephrase(observation, rule)
# rephrased_observation будет содержать перефразированный текст, сгенерированный LLM, например: "Сегодня мне весело."

# Пример 2: Адаптация к стилю
observation = "Я пошел в магазин."
rule = "Говори в формальном стиле."
rephrased_observation = rephrase(observation, rule)
# rephrased_observation будет содержать перефразированный текст, сгенерированный LLM, например: "Я посетил магазин."
```

### `restructure_as_observed_vs_expected`

```python
@llm()
def restructure_as_observed_vs_expected(description: str) -> str:
    """
    Реструктурирует описание события или концепции, нарушающей или соответствующей ожиданию,
    извлекая элементы: OBSERVED, BROKEN EXPECTATION/MET EXPECTATION, REASONING.

    Args:
        description (str): Описание события или концепции, которое либо нарушает, либо соответствует ожиданию.

    Returns:
        str: Реструктурированное описание.
    """
```

**Как работает функция**:

Функция `restructure_as_observed_vs_expected` анализирует входное описание (`description`) и выделяет из него три ключевых элемента:
- `OBSERVED`: Фактическое наблюдение или событие.
- `BROKEN EXPECTATION` или `MET EXPECTATION`: Ожидание, которое было нарушено или выполнено, соответственно.
- `REASONING`: Обоснование этого ожидания.

Декоратор `@llm()` указывает на то, что для извлечения этих элементов используется языковая модель.
Функция предназначена для структурирования информации таким образом, чтобы было легче анализировать соответствие событий ожиданиям.

```ascii
Описание события/концепции
     ↓
Языковая модель (LLM)
     ↓
Реструктурированное описание (OBSERVED, BROKEN/MET EXPECTATION, REASONING)
```

**Примеры**:

```python
# Пример 1: Нарушение ожидания
description = "Аня сказала, что ей понравилась новая острая гаспачо, хотя она не любит острое."
restructured_description = restructure_as_observed_vs_expected(description)
# restructured_description будет содержать:
# "OBSERVED: Аня сказала, что ей понравилась новая острая гаспачо.
#  BROKEN EXPECTATION: Аня должна была сказать, что ей не понравилась новая острая гаспачо.
#  REASONING: Аня не любит острое."

# Пример 2: Соответствие ожиданиям
description = "Карлос поехал во Флоренцию и был поражен красотой города. Это соответствовало его любви к искусству и архитектуре."
restructured_description = restructure_as_observed_vs_expected(description)
# restructured_description будет содержать:
# "OBSERVED: Карлос поехал во Флоренцию и был поражен красотой города.
#  MET EXPECTATION: Карлос должен был быть поражен красотой города.
#  REASONING: Карлос любит искусство и архитектуру."