# Модуль `misc`

## Обзор

Модуль `misc` содержит набор вспомогательных функций, используемых в проекте `hypotez` для различных целей, таких как получение имени объекта, вычисление хеша и генерация уникальных идентификаторов. Он предоставляет утилиты для работы с агентами и окружениями в контексте `TinyTroupe`.

## Подробней

Этот модуль предоставляет несколько полезных функций, которые упрощают выполнение общих задач, таких как получение имени объекта, вычисление хеша и генерация уникальных ID. Функции предназначены для работы с объектами `TinyPerson` и `TinyWorld`.

## Функции

### `name_or_empty`

```python
def name_or_empty(named_entity: AgentOrWorld):
    """
    Возвращает имя указанного агента или окружения или пустую строку, если агент равен None.

    Args:
        named_entity (AgentOrWorld): Агент или окружение, имя которого нужно получить.

    Returns:
        str: Имя агента или окружения или пустая строка.
    """
    ...
```

**Назначение**: Возвращает имя объекта `named_entity`, если он не `None`, иначе возвращает пустую строку.

**Параметры**:
- `named_entity` (`AgentOrWorld`): Объект, для которого нужно получить имя. Тип `AgentOrWorld` является объединением типов `TinyPerson` и `TinyWorld`.

**Возвращает**:
- `str`: Имя объекта, если он существует, иначе пустая строка.

**Как работает функция**:
1. Проверяет, является ли входной объект `named_entity` равным `None`.
2. Если объект `None`, возвращает пустую строку.
3. В противном случае возвращает атрибут `name` объекта.

```
Проверка named_entity на None
|
Нет --> Возвращает named_entity.name
|
Да --> Возвращает ""
```

**Примеры**:

```python
from typing import Union
class TinyPerson:
    def __init__(self, name: str):
        self.name = name

class TinyWorld:
    def __init__(self, name: str):
        self.name = name
AgentOrWorld = Union[TinyPerson, TinyWorld]

person = TinyPerson(name="Alice")
world = TinyWorld(name="Wonderland")

print(name_or_empty(person))  # Вывод: Alice
print(name_or_empty(world))   # Вывод: Wonderland
print(name_or_empty(None))    # Вывод:
```

### `custom_hash`

```python
def custom_hash(obj):
    """
    Возвращает хеш для указанного объекта. Объект сначала преобразуется
    в строку, чтобы сделать его хешируемым. Этот метод является детерминированным,
    в отличие от встроенной функции hash().
    """
    ...
```

**Назначение**: Вычисляет SHA-256 хеш для переданного объекта.

**Параметры**:
- `obj` (any): Объект, для которого нужно вычислить хеш.

**Возвращает**:
- `str`: SHA-256 хеш объекта в виде шестнадцатеричной строки.

**Как работает функция**:
1. Преобразует входной объект в строку с помощью `str(obj)`.
2. Кодирует полученную строку в байты с использованием кодировки UTF-8.
3. Вычисляет SHA-256 хеш с помощью `hashlib.sha256()`.
4. Возвращает хеш в виде шестнадцатеричной строки с помощью `hexdigest()`.

```
Преобразование объекта в строку
|
Кодирование строки в байты (UTF-8)
|
Вычисление SHA-256 хеша
|
Возврат хеша в виде шестнадцатеричной строки
```

**Примеры**:

```python
print(custom_hash("example"))  # Вывод: 9c832310a2d38a9f427643ca82ca2916f749413691dd2241285c15b24d2241e7
print(custom_hash(123))       # Вывод: a665a45920422f9d417e4867efdc4fb8a04a1f3fff21034a4156985bb649ca4a
```

### `fresh_id`

```python
def fresh_id():
    """
    Возвращает свежий ID для нового объекта. Это полезно для генерации уникальных ID для объектов.
    """
    ...
```

**Назначение**: Генерирует и возвращает новый уникальный идентификатор.

**Возвращает**:
- `int`: Новый уникальный идентификатор.

**Как работает функция**:
1. Использует глобальную переменную `_fresh_id_counter` для хранения текущего значения счетчика.
2. Увеличивает значение `_fresh_id_counter` на 1.
3. Возвращает новое значение `_fresh_id_counter`.

```
Увеличение глобального счетчика _fresh_id_counter
|
Возврат нового значения счетчика
```

**Примеры**:

```python
print(fresh_id())  # Вывод: 1
print(fresh_id())  # Вывод: 2
print(fresh_id())  # Вывод: 3
```

### `reset_fresh_id`

```python
def reset_fresh_id():
    """
    Сбрасывает счетчик свежих ID. Это полезно для целей тестирования.
    """
    ...
```

**Назначение**: Сбрасывает счетчик уникальных идентификаторов `_fresh_id_counter` в 0.

**Как работает функция**:
1. Устанавливает значение глобальной переменной `_fresh_id_counter` в 0.

```
Установка глобального счетчика _fresh_id_counter в 0
```

**Примеры**:

```python
print(fresh_id())  # Вывод: 1
reset_fresh_id()
print(fresh_id())  # Вывод: 1 (после сброса)