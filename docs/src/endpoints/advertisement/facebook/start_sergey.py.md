# Модуль для отправки рекламных объявлений в Facebook

## Обзор

Модуль `src.endpoints.advertisement.facebook.start_sergey` предназначен для автоматической отправки рекламных объявлений в группы Facebook. Он использует драйвер веб-браузера для навигации по Facebook и размещения объявлений в различных группах.

## Подробнее

Модуль предназначен для автоматизации процесса размещения рекламы в Facebook, ориентируясь на различные языковые группы и категории. Он использует файлы конфигурации для определения групп и рекламных текстов, а также предоставляет возможность запуска рекламных кампаний как для "Казаринова", так и для "Aliexpress".
Модуль `start_sergey.py` является частью системы `hypotez` и выполняет end-to-end размещение рекламы в социальной сети Facebook.
В коде происходит итерация по языкам и валютам, определение файлов с группами для размещения рекламы, и запуск цикла рекламных кампаний, определенных в файлах конфигурации.

## Функции

### `run_campaign`

```python
def run_campaign(d: Driver, promoter_name: str, campaigns: list | str, group_file_paths: list, language: str, currency: str):
    """Запуск рекламной кампании.

    Args:
        d (Driver): Экземпляр драйвера.
        promoter_name (str): Имя рекламодателя.
        campaigns (list): Список кампаний.
        group_file_paths (list): Пути к файлам с группами.
        language (str): Язык рекламной кампании.
        currency (str): Валюта рекламной кампании.
    """
```

**Назначение**: Запускает рекламную кампанию с использованием указанных параметров.

**Параметры**:
- `d` (Driver): Экземпляр драйвера веб-браузера.
- `promoter_name` (str): Имя рекламодателя.
- `campaigns` (list | str): Список кампаний для запуска.
- `group_file_paths` (list): Список путей к файлам, содержащим информацию о группах Facebook, в которых будет размещаться реклама.
- `language` (str): Язык рекламной кампании.
- `currency` (str): Валюта рекламной кампании.

**Как работает функция**:

1.  **Инициализация промоутера**: Создается экземпляр класса `FacebookPromoter` с использованием переданного драйвера и имени рекламодателя.
2.  **Запуск кампаний**: Вызывается метод `run_campaigns` экземпляра `FacebookPromoter` с передачей списка кампаний, путей к файлам групп, категорий групп для рекламы, языка и валюты. Также указывается, что видео не будет использоваться (`no_video=False`).

```
A: Создание экземпляра FacebookPromoter
|
B: Запуск рекламных кампаний через promoter.run_campaigns
```

### `campaign_cycle`

```python
def campaign_cycle(d: Driver):
    """Цикл для управления запуском кампаний.

    Args:
        d (Driver): Экземпляр драйвера.
        aliexpress_adv (bool): Флаг для определения рекламодателя.
    """
```

**Назначение**: Управляет циклом запуска рекламных кампаний для разных языков и валют.

**Параметры**:
- `d` (Driver): Экземпляр драйвера веб-браузера.

**Как работает функция**:

1.  **Определение путей к файлам**: Создаются копии списков `group_file_paths_ru`, `adv_file_paths_ru`, `group_file_paths_he` и `adv_file_paths_he`, которые расширяются для включения путей ко всем необходимым файлам.
2.  **Пары язык-валюта**: Определяется список словарей `language_currency_pairs`, содержащий пары язык-валюта для рекламных кампаний (`[{"HE": "ILS"},{"RU": "ILS"},]`).
3.  **Итерация по языкам и валютам**:
    *   Происходит итерация по списку `language_currency_pairs`, из каждого словаря извлекаются язык и валюта.
    *   На основе языка (`language`) определяется, какие файлы групп использовать (`file_paths_ru` для русского языка, `file_paths_he` для иврита).
    *   Определяется список кампаний (`campaigns`) на основе языка (`kazarinov_ru` для русского, `kazarinov_he` для иврита).
    *   Для каждой кампании вызывается функция `run_campaign` с передачей драйвера, имени рекламодателя (`kazarinov`), имени кампании, путей к файлам групп, языка и валюты.
    *   Получает список кампаний для aliexpress из директории `gs.path.google_drive / \'aliexpress\' / \'campaigns\'`
    *   Запускает рекламные кампании для aliexpress.
4.  **Завершение цикла**: Функция возвращает `True` после завершения всех итераций.

```
A: Определение путей к файлам групп и рекламных материалов
|
B: Итерация по парам язык-валюта
|
C: Определение списка кампаний на основе языка
|
D: Запуск кампании через run_campaign
```

### `main`

```python
def main():
    """Основная функция для запуска рекламных кампаний."""
```

**Назначение**: Основная функция для запуска рекламных кампаний.

**Как работает функция**:

1.  **Инициализация драйвера**: Создается экземпляр драйвера веб-браузера Chrome и открывается страница Facebook.
2.  **Основной цикл**:
    *   Функция входит в бесконечный цикл `while True`.
    *   Проверяется, наступил ли интервал для выполнения действий с помощью функции `interval()`. Если функция возвращает `True`, программа ждет 1000 секунд.
    *   Вызывается функция `campaign_cycle` для запуска рекламных кампаний.
    *   Выполняется логирование текущего времени и устанавливается случайная задержка от 30 до 360 секунд перед следующей итерацией цикла.
3.  **Обработка прерывания**: Если возникает прерывание с клавиатуры (KeyboardInterrupt), программа записывает информационное сообщение в лог.

**Примеры**:

```python
# Пример запуска функции main
if __name__ == "__main__":
    main()
```
```
A: Инициализация драйвера Chrome и открытие Facebook
|
B: Бесконечный цикл
|
C: Проверка интервала времени (interval())
|
D: Запуск цикла кампаний (campaign_cycle(d))
|
E: Логирование и задержка перед следующей итерацией