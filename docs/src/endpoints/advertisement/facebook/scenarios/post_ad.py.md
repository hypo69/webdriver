# Модуль `post_ad`

## Обзор

Модуль предназначен для публикации рекламных сообщений в группах Facebook. Он содержит функцию `post_ad`, которая автоматизирует процесс отправки заголовка, загрузки медиафайлов и публикации сообщения с использованием Selenium WebDriver.

## Подробней

Модуль `post_ad` является частью функциональности по автоматизации рекламы в Facebook в проекте `hypotez`. Он использует Selenium WebDriver для взаимодействия с веб-интерфейсом Facebook, отправляет заголовок сообщения, загружает медиафайлы (например, изображения) и публикует сообщение. Модуль включает в себя обработку ошибок и логирование для обеспечения надежности и информативности процесса публикации.

## Функции

### `post_ad`

```python
def post_ad(d: Driver, message: SimpleNamespace) -> bool:
    """
    Отправляет рекламное сообщение.

    Args:
        d (Driver): Инстанс драйвера, используемый для взаимодействия с веб-страницей.
        message (SimpleNamespace): Объект, содержащий данные для рекламного сообщения, включая описание и путь к изображению.

    Returns:
        bool: `True`, если сообщение успешно опубликовано, иначе `None`.
    """
```

**Назначение**: Функция `post_ad` автоматизирует процесс публикации рекламного сообщения в Facebook. Она отправляет заголовок сообщения, загружает медиафайлы (если они есть) и публикует сообщение.

**Параметры**:
- `d` (Driver): Инстанс драйвера, используемый для взаимодействия с веб-страницей. Драйвер должен быть инициализирован и настроен для работы с Facebook.
- `message` (SimpleNamespace): Объект `SimpleNamespace`, содержащий данные для рекламного сообщения. Обязательно должен включать атрибут `description` (описание сообщения) и может включать атрибут `image_path` (путь к изображению для загрузки).

**Возвращает**:
- `bool`: `True`, если сообщение успешно опубликовано, иначе `None`.

**Как работает функция**:
1. **Отправка заголовка сообщения**: Функция вызывает `post_message_title` для отправки описания сообщения. В случае неудачи увеличивается счетчик ошибок `fails`. Если количество ошибок превышает 15, функция завершается.
2. **Загрузка медиафайлов**: Если в объекте `message` присутствует атрибут `image_path`, функция вызывает `upload_post_media` для загрузки медиафайла.
3. **Публикация сообщения**: Функция вызывает `message_publish` для публикации сообщения.
4. **Обработка ошибок**: В случае неудачи на любом из этапов функция логирует ошибку и возвращает `None`.
5. **Сброс счетчика ошибок**: При успешной публикации счетчик ошибок `fails` сбрасывается.

**ASCII Flowchart**:

```
Начало
  |
  v
Отправка заголовка сообщения (post_message_title)
  |
  v
Проверка наличия image_path
  |
  +-- Да --> Загрузка медиафайла (upload_post_media)
  |  
  +-- Нет
  |
  v
Публикация сообщения (message_publish)
  |
  v
Конец
```

**Примеры**:

```python
from types import SimpleNamespace
from src.webdriver.driver import Driver
from src.endpoints.advertisement.facebook.scenarios.post_ad import post_ad

# Пример 1: Успешная публикация сообщения с изображением
driver = Driver(...)  # Инициализация драйвера
message = SimpleNamespace(description="Текст сообщения", image_path="path/to/image.jpg")
result = post_ad(driver, message)
print(f"Результат публикации: {result}")  # Вывод: Результат публикации: True

# Пример 2: Публикация сообщения без изображения
driver = Driver(...)  # Инициализация драйвера
message = SimpleNamespace(description="Текст сообщения")
result = post_ad(driver, message)
print(f"Результат публикации: {result}")  # Вывод: Результат публикации: True

# Пример 3: Неудачная публикация сообщения
driver = Driver(...)  # Инициализация драйвера
message = SimpleNamespace(description="Текст сообщения")
driver.post_message_title = lambda d, title: False  # Эмулируем ошибку при отправке заголовка
result = post_ad(driver, message)
print(f"Результат публикации: {result}")  # Вывод: Результат публикации: None