# Модуль для работы с устаревшим провайдером V50 gpt4free
=================================================================

Модуль содержит класс `V50`, который предоставляет доступ к API `https://p5.v50.ltd` для работы с моделями GPT.
Данный провайдер помечен как устаревший (`deprecated`) и может быть удален или заменен в будущих версиях.

## Обзор

Модуль `V50` является устаревшим провайдером в рамках библиотеки `gpt4free`, предназначенным для взаимодействия с определенной версией API `https://p5.v50.ltd`. Он предоставляет функциональность для создания запросов к модели GPT и получения ответов. Важно отметить, что данный провайдер помечен как устаревший и может быть удален или заменен в будущих версиях библиотеки.

## Подробнее

Модуль `V50` реализует класс `AbstractProvider`, предоставляя метод `create_completion` для отправки запросов к API и получения результатов. Он поддерживает модель `gpt-3.5-turbo`, но не поддерживает потоковую передачу данных. Для работы с данным провайдером не требуется аутентификация.

## Классы

### `V50`

**Описание**: Класс `V50` предоставляет интерфейс для взаимодействия с API `https://p5.v50.ltd`.

**Наследует**:
- `AbstractProvider`: Наследует базовый класс для провайдеров.

**Атрибуты**:
- `url` (str): URL API `https://p5.v50.ltd`.
- `supports_gpt_35_turbo` (bool): Указывает, что провайдер поддерживает модель `gpt-3.5-turbo`.
- `supports_stream` (bool): Указывает, что провайдер не поддерживает потоковую передачу.
- `needs_auth` (bool): Указывает, что для работы с провайдером не требуется аутентификация.
- `working` (bool): Указывает, что провайдер в данный момент работает (`False`, так как провайдер устарел).

### `create_completion`

```python
    @staticmethod
    def create_completion(
        model: str,
        messages: list[dict[str, str]],
        stream: bool, **kwargs: Any) -> CreateResult:
        """
        Создает запрос к API для получения завершения текста на основе предоставленных сообщений.

        Args:
            model (str): Идентификатор используемой модели.
            messages (list[dict[str, str]]): Список сообщений для контекста запроса.
            stream (bool): Указывает, следует ли использовать потоковую передачу (не поддерживается).
            **kwargs (Any): Дополнительные параметры запроса, такие как `temperature`, `top_p` и `proxy`.

        Returns:
            CreateResult: Результат запроса, представляющий собой генератор текста.

        Raises:
            Не вызывает исключений напрямую, но может возникнуть исключение `requests.exceptions.RequestException` при неудачном запросе к API.

        """
```

**Назначение**: Создает запрос к API для получения завершения текста на основе предоставленных сообщений.

**Параметры**:
- `model` (str): Идентификатор используемой модели.
- `messages` (list[dict[str, str]]): Список сообщений для контекста запроса.
- `stream` (bool): Указывает, следует ли использовать потоковую передачу (не поддерживается).
- `**kwargs` (Any): Дополнительные параметры запроса, такие как `temperature`, `top_p` и `proxy`.

**Возвращает**:
- `CreateResult`: Результат запроса, представляющий собой генератор текста.

**Вызывает исключения**:
- Не вызывает исключений напрямую, но может возникнуть исключение `requests.exceptions.RequestException` при неудачном запросе к API.

**Как работает функция**:

1. **Формирование запроса**: Функция преобразует список сообщений в строку, объединяя роль и содержимое каждого сообщения.
2. **Создание полезной нагрузки (payload)**: Формируется словарь `payload`, содержащий параметры запроса, такие как промпт, параметры модели (температура, `top_p`), идентификатор пользователя и другие опции.
3. **Определение заголовков (headers)**: Определяются заголовки HTTP-запроса, включающие информацию о типе контента, User-Agent и другие параметры.
4. **Отправка запроса**: Отправляется POST-запрос к API `https://p5.v50.ltd/api/chat-process` с использованием библиотеки `requests`.
5. **Обработка ответа**: Если ответ не содержит определенную строку `"https://fk1.v50.ltd"`, функция возвращает текст ответа через генератор.

**ASCII схема работы функции**:

```
Начало
  ↓
Формирование запроса (conversation)
  ↓
Создание payload
  ↓
Определение headers
  ↓
Отправка POST-запроса к API
  ↓
Проверка наличия "https://fk1.v50.ltd" в ответе
  ├── Нет → Возврат текста ответа
  └── Да → Конец
Конец
```

**Примеры**:

Пример 1:

```python
model = "gpt-3.5-turbo"
messages = [{"role": "user", "content": "Hello!"}]
stream = False
kwargs = {"temperature": 0.5, "top_p": 0.5}

result = V50.create_completion(model, messages, stream, **kwargs)
for chunk in result:
    print(chunk)
```

Пример 2:

```python
model = "gpt-3.5-turbo"
messages = [{"role": "user", "content": "Tell me a joke."}]
stream = False
kwargs = {"proxy": {"http": "http://your_proxy", "https": "https://your_proxy"}}

result = V50.create_completion(model, messages, stream, **kwargs)
for chunk in result:
    print(chunk)