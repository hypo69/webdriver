# Модуль AiAsk
## Обзор

Модуль `AiAsk` предоставляет асинхронный генератор для взаимодействия с сервисом `aiask.me`. Он поддерживает модели GPT-3.5 Turbo и обеспечивает сохранение истории сообщений. Модуль использует `aiohttp` для асинхронных HTTP-запросов.

## Подробней

Этот модуль предназначен для интеграции с сервисом `aiask.me` для генерации текста на основе предоставленных сообщений. Он отправляет запросы к API `aiask.me` и возвращает сгенерированный текст частями, используя асинхронный генератор. В случае достижения лимита запросов, выбрасывается исключение `RuntimeError`.
## Классы

### `AiAsk`

**Описание**: Класс `AiAsk` является провайдером асинхронного генератора, который взаимодействует с API `aiask.me`.

**Наследует**:
- `AsyncGeneratorProvider`:  унаследован от базового класса `AsyncGeneratorProvider`, который обеспечивает структуру для асинхронных провайдеров генераторов.

**Аттрибуты**:
- `url` (str): URL сервиса `aiask.me`.
- `supports_message_history` (bool): Указывает, поддерживает ли провайдер историю сообщений (в данном случае `True`).
- `supports_gpt_35_turbo` (bool): Указывает, поддерживает ли провайдер модель GPT-3.5 Turbo (в данном случае `True`).
- `working` (bool): Указывает, работает ли провайдер в данный момент (в данном случае `False`).

**Методы**:
- `create_async_generator`: Создает асинхронный генератор для получения ответов от API `aiask.me`.

## Функции

### `create_async_generator`

```python
    @classmethod
    async def create_async_generator(
        cls,
        model: str,
        messages: Messages,
        proxy: str = None,
        **kwargs
    ) -> AsyncResult:
        """
        Создает асинхронный генератор для получения ответов от API `aiask.me`.
    
        Args:
            model (str): Модель для генерации текста.
            messages (Messages): Список сообщений для отправки в API.
            proxy (str, optional): Прокси-сервер для использования. По умолчанию `None`.
            **kwargs: Дополнительные параметры, такие как температура.
    
        Returns:
            AsyncResult: Асинхронный генератор, возвращающий сгенерированный текст частями.
    
        Raises:
            RuntimeError: Если достигнут лимит запросов.
        """
```

**Назначение**: Функция `create_async_generator` создает и возвращает асинхронный генератор, который отправляет запросы к API `aiask.me` и возвращает сгенерированный текст частями.

**Параметры**:
- `cls`: Ссылка на класс `AiAsk`.
- `model` (str): Модель для генерации текста.
- `messages` (Messages): Список сообщений для отправки в API.
- `proxy` (str, optional): Прокси-сервер для использования. По умолчанию `None`.
- `**kwargs`: Дополнительные параметры, такие как `temperature`.

**Возвращает**:
- `AsyncResult`: Асинхронный генератор, возвращающий сгенерированный текст частями.

**Вызывает исключения**:
- `RuntimeError`: Если достигнут лимит запросов.

**Как работает функция**:

1. **Подготовка заголовков**: Функция создает заголовки HTTP-запроса, включая `accept`, `origin` и `referer`.
2. **Создание сессии**: Используется асинхронная сессия `aiohttp.ClientSession` для выполнения запросов.
3. **Формирование данных**: Создается словарь `data` с параметрами запроса, включая список сообщений, модель и температуру.
4. **Отправка запроса**: Отправляется POST-запрос к API `aiask.me` с использованием `session.post`.
5. **Обработка ответа**: Функция итерируется по частям ответа (`chunk`) и декодирует их. Если ответ начинается с сообщения о лимите запросов, выбрасывается исключение `RuntimeError`.

```
Заголовки и данные запроса
     ↓
   Создание асинхронной сессии
     ↓
   Отправка POST запроса к API
     ↓
   Получение ответа по частям (chunks)
     ↓
   Проверка на лимит запросов
     ├── Да: Выброс RuntimeError
     └── Нет: Генерация текста
     ↓
  Возврат результата (генератора текста)
```

**Примеры**:

```python
# Пример использования (необходимо обернуть в асинхронную функцию)
# messages = [{"role": "user", "content": "Hello, world!"}]
# async for chunk in AiAsk.create_async_generator(model="gpt-3.5-turbo", messages=messages):
#     print(chunk, end="")