# Модуль для запуска веб-интерфейса g4f

## Обзор

Модуль `webview.py` отвечает за запуск веб-интерфейса приложения `g4f`. Он использует библиотеку `webview` для создания и управления окном приложения, а также предоставляет API для взаимодействия между веб-интерфейсом и серверной частью приложения.

## Подробнее

Этот модуль является ключевым компонентом графического интерфейса `g4f`. Он создает окно, в котором отображается веб-интерфейс, загруженный из директории `client`. Модуль также настраивает параметры запуска веб-интерфейса, такие как порт, использование SSL и путь для хранения данных.

## Функции

### `run_webview`

```python
def run_webview(
    debug: bool = False,
    http_port: int = None,
    ssl: bool = True,
    storage_path: str = None,
    gui: str = None
):
    """Запускает веб-интерфейс g4f в отдельном окне.

    Args:
        debug (bool, optional): Включает режим отладки. По умолчанию `False`.
        http_port (int, optional): Порт для запуска HTTP-сервера. По умолчанию `None`.
        ssl (bool, optional): Использовать SSL. По умолчанию `True`.
        storage_path (str, optional): Путь для хранения данных веб-приложения. По умолчанию `None`.
        gui (str, optional): Не используется.

    Raises:
        ImportError: Если не установлена библиотека `platformdirs`.

    Example:
        >>> run_webview(debug=True, http_port=8080, ssl=False)
    """
    ...
```

**Назначение**: Функция `run_webview` настраивает и запускает веб-интерфейс `g4f`. Она определяет путь к файлам веб-интерфейса, создает окно с помощью библиотеки `webview`, настраивает параметры запуска и запускает веб-интерфейс.

**Параметры**:

-   `debug` (bool, optional): Включает режим отладки. По умолчанию `False`.
-   `http_port` (int, optional): Порт для запуска HTTP-сервера. По умолчанию `None`.
-   `ssl` (bool, optional): Использовать SSL. По умолчанию `True`.
-   `storage_path` (str, optional): Путь для хранения данных веб-приложения. По умолчанию `None`.
-   `gui` (str, optional): Не используется.

**Возвращает**:

-   `None`: Функция ничего не возвращает.

**Вызывает исключения**:

-   `ImportError`: Если не установлена библиотека `platformdirs`.

**Как работает функция**:

1.  Определяет путь к файлам веб-интерфейса. Если приложение запущено как исполняемый файл, используется путь к временной директории, созданной упаковщиком. В противном случае используется путь к директории с исходным кодом.
2.  Настраивает параметры библиотеки `webview`, такие как открытие внешних ссылок в браузере и разрешение загрузок.
3.  Создает окно с помощью `webview.create_window`, передавая заголовок окна, путь к файлу `index.html` и экземпляр класса `JsApi` для взаимодействия между веб-интерфейсом и серверной частью приложения.
4.  Определяет путь для хранения данных веб-приложения. Если библиотека `platformdirs` установлена и параметр `storage_path` не передан, используется путь к директории конфигурации пользователя.
5.  Запускает веб-интерфейс с помощью `webview.start`, передавая параметры запуска, такие как приватный режим, путь для хранения данных, режим отладки, порт и использование SSL.

**ASCII flowchart функции `run_webview`**:

```
Определение пути к файлам веб-интерфейса
↓
Настройка параметров библиотеки webview
↓
Создание окна webview.create_window
↓
Определение пути для хранения данных веб-приложения
↓
Запуск веб-интерфейса webview.start
```

**Примеры**:

```python
run_webview(debug=True, http_port=8080, ssl=False)
run_webview(storage_path="/tmp/g4f-webview")
```

## Переменные

-   `dirname` (str): Путь к директории, содержащей файлы веб-интерфейса.
-   `has_platformdirs` (bool): Флаг, указывающий, установлена ли библиотека `platformdirs`.
-   `parser`: Экземпляр класса `gui_parser` для разбора аргументов командной строки.
-   `args`: Результат разбора аргументов командной строки.

## Дополнительная информация

В коде используются следующие сторонние библиотеки:

-   `webview`: Для создания и управления веб-интерфейсом.
-   `platformdirs`: Для определения пути к директории конфигурации пользователя.
-   `g4f.gui.gui_parser`: Для разбора аргументов командной строки.
-   `g4f.gui.server.js_api`: Для взаимодействия между веб-интерфейсом и серверной частью приложения.
-   `g4f.version`: Для получения текущей версии приложения.
-   `g4f.debug`: Для включения режима отладки.