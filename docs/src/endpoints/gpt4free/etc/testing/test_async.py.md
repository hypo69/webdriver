# Модуль для асинхронного тестирования провайдеров g4f

## Обзор

Модуль предназначен для асинхронного тестирования различных провайдеров g4f (gpt4free). Он позволяет проверить работоспособность провайдеров, отправляя им запросы и логируя время выполнения.

## Подробней

Этот модуль используется для проверки и оценки производительности различных провайдеров, предоставляющих доступ к моделям GPT. Он запускает асинхронные тесты для каждого работоспособного провайдера и собирает результаты, включая время выполнения и ответы.

## Функции

### `create_async`

```python
async def create_async(provider):
    """
    Асинхронно создает запрос к провайдеру и логирует время выполнения.

    Args:
        provider: Провайдер для тестирования.

    Returns:
        None

    Raises:
        Exception: Если во время запроса к провайдеру возникает исключение.

    Example:
        Примеры вызова со всем спектром параметров. которы можно передать в функцию
        async def test():
            await create_async(g4f.Provider.Ails)
    """
```

**Как работает функция**:

1.  Функция `create_async` принимает объект `provider` в качестве аргумента.
2.  Она пытается выполнить асинхронный запрос к провайдеру, используя метод `provider.create_async`.
3.  Для измерения времени выполнения используется функция `log_time_async`.
4.  В запросе передается сообщение с ролью "user" и содержанием "Hello, are you GPT 3.5?".
5.  Если запрос выполняется успешно, функция выводит имя провайдера и полученный ответ.
6.  Если во время запроса возникает исключение, функция выводит имя провайдера, имя класса исключения и текст исключения.

```text
create_async(provider)
|
-- log_time_async(provider.create_async)
|
Получение ответа или ошибки
|
Вывод результата
```

### `run_async`

```python
async def run_async():
    """
    Асинхронно запускает тесты для всех работоспособных провайдеров.

    Args:
        None

    Returns:
        None

    Raises:
        None

    Example:
        Примеры вызова со всем спектром параметров. которы можно передать в функцию
        async def main():
            await run_async()
    """
```

**Как работает функция**:

1.  Функция `run_async` создает список асинхронных задач `responses`.
2.  Для каждого провайдера, который помечен как `working`, создается задача `create_async(provider)`.
3.  Функция `asyncio.gather` используется для одновременного выполнения всех задач в списке `responses`.
4.  После завершения всех задач функция завершается.

```text
run_async()
|
-- Создание списка задач create_async(provider) для рабочих провайдеров
|
Запуск задач asyncio.gather(*responses)
|
Завершение
```

### Основной блок

```python
print("Total:", asyncio.run(log_time_async(run_async)))
```

**Как работает функция**:

1.  Вызывается функция `run_async` для запуска асинхронных тестов.
2.  Время выполнения `run_async` измеряется с помощью `log_time_async`.
3.  Функция `asyncio.run` запускает асинхронную операцию и блокирует выполнение до ее завершения.
4.  В конце выводится общее время выполнения тестов.