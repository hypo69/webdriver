# Модуль для логирования времени выполнения

## Обзор

Модуль содержит функции для измерения времени выполнения других функций. Он предоставляет три функции: `log_time_async`, `log_time_yield` и `log_time`, каждая из которых предназначена для логирования времени выполнения асинхронных, генерирующих и обычных синхронных функций, соответственно.
В проекте `hypotez` этот модуль используется для отладки и оптимизации, позволяя разработчикам видеть, какие части кода занимают больше всего времени.

## Функции

### `log_time_async`

```python
async def log_time_async(method: callable, **kwargs):
    """
    Измеряет и логирует время выполнения асинхронной функции.

    Args:
        method (callable): Асинхронная функция, время выполнения которой необходимо измерить.
        **kwargs: Произвольные ключевые аргументы, передаваемые в функцию `method`.

    Returns:
        str: Результат выполнения `method` вместе с временем выполнения в секундах.
             Если результат выполнения `method` равен `None`, возвращает только время выполнения.
    """
```

**Как работает функция**:

1.  **Замер времени**: Функция фиксирует время начала выполнения переданной асинхронной функции `method`.
2.  **Выполнение функции**: Выполняет асинхронную функцию `method` с переданными аргументами `kwargs` и сохраняет результат.
3.  **Расчет времени**: Вычисляет время, затраченное на выполнение функции, путем вычитания времени начала из текущего времени.
4.  **Формирование результата**: Форматирует время выполнения в строку. Если результат выполнения функции не равен `None`, возвращает строку, объединяющую результат выполнения функции и время выполнения. Если результат равен `None`, возвращает только строку со временем выполнения.

```
Замер времени (start = time())
↓
Выполнение асинхронной функции method(**kwargs)
↓
Вычисление времени выполнения (secs = f"{round(time() - start, 2)} secs")
↓
Формирование результата (return " ".join([result, secs]) if result else secs)
```

**Примеры**:

```python
import asyncio

async def my_async_function(delay: int = 1) -> str:
    """Пример асинхронной функции."""
    await asyncio.sleep(delay)
    return "Async function completed"

async def main():
    """Пример использования log_time_async."""
    result = await log_time_async(my_async_function, delay=2)
    print(result)  # Вывод: Async function completed 2.01 secs

asyncio.run(main())
```

### `log_time_yield`

```python
def log_time_yield(method: callable, **kwargs):
    """
    Измеряет и логирует время выполнения функции-генератора.

    Args:
        method (callable): Функция-генератор, время выполнения которой необходимо измерить.
        **kwargs: Произвольные ключевые аргументы, передаваемые в функцию `method`.

    Yields:
        str: Значения, генерируемые функцией `method`, а также время выполнения в секундах после завершения работы генератора.
    """
```

**Как работает функция**:

1.  **Замер времени**: Функция фиксирует время начала выполнения переданной функции-генератора `method`.
2.  **Выполнение генератора**: Выполняет функцию-генератор `method` с переданными аргументами `kwargs`, используя `yield from` для получения значений из генератора.
3.  **Расчет времени**: Вычисляет время, затраченное на выполнение функции, путем вычитания времени начала из текущего времени.
4.  **Генерация времени**: После завершения генератора, функция генерирует строку, содержащую время выполнения в секундах.

```
Замер времени (start = time())
↓
Выполнение генератора (yield from method(**kwargs))
↓
Вычисление времени выполнения (f" {round(time() - start, 2)} secs")
↓
Генерация времени (yield f" {round(time() - start, 2)} secs")
```

**Примеры**:

```python
def my_generator_function(count: int) -> str:
    """Пример функции-генератора."""
    for i in range(count):
        yield f"Yielded {i}"

def main():
    """Пример использования log_time_yield."""
    for value in log_time_yield(my_generator_function, count=3):
        print(value)

main()
# Yielded 0
# Yielded 1
# Yielded 2
#  0.0 secs
```

### `log_time`

```python
def log_time(method: callable, **kwargs):
    """
    Измеряет и логирует время выполнения обычной синхронной функции.

    Args:
        method (callable): Функция, время выполнения которой необходимо измерить.
        **kwargs: Произвольные ключевые аргументы, передаваемые в функцию `method`.

    Returns:
        str: Результат выполнения `method` вместе с временем выполнения в секундах.
             Если результат выполнения `method` равен `None`, возвращает только время выполнения.
    """
```

**Как работает функция**:

1.  **Замер времени**: Функция фиксирует время начала выполнения переданной функции `method`.
2.  **Выполнение функции**: Выполняет функцию `method` с переданными аргументами `kwargs` и сохраняет результат.
3.  **Расчет времени**: Вычисляет время, затраченное на выполнение функции, путем вычитания времени начала из текущего времени.
4.  **Формирование результата**: Форматирует время выполнения в строку. Если результат выполнения функции не равен `None`, возвращает строку, объединяющую результат выполнения функции и время выполнения. Если результат равен `None`, возвращает только строку со временем выполнения.

```
Замер времени (start = time())
↓
Выполнение функции method(**kwargs)
↓
Вычисление времени выполнения (secs = f"{round(time() - start, 2)} secs")
↓
Формирование результата (return " ".join([result, secs]) if result else secs)
```

**Примеры**:

```python
def my_function(param: str) -> str:
    """Пример обычной функции."""
    return f"Function executed with {param}"

def main():
    """Пример использования log_time."""
    result = log_time(my_function, param="example")
    print(result)  # Вывод: Function executed with example 0.0 secs

main()