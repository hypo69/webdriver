# Модуль для работы с провайдером Forefront
## Обзор

Модуль предоставляет функциональность для взаимодействия с провайдером Forefront, используя его API для генерации текста на основе модели gpt-3.5-turbo. Он поддерживает потоковую передачу данных и не требует аутентификации.

## Подробней

Этот модуль предназначен для интеграции с сервисом Forefront, позволяя отправлять запросы на генерацию текста и получать ответы в потоковом режиме. Он определяет параметры подключения, такие как URL и используемая модель, а также реализует функцию для создания запросов к API Forefront.
Модуль `Forefront` является частью проекта `hypotez` и предназначен для обеспечения возможности взаимодействия с API `Forefront` для генерации ответов. Модуль использует библиотеку `requests` для отправки HTTP-запросов и библиотеку `json` для обработки данных в формате `JSON`.

## Функции

### `_create_completion`

```python
def _create_completion(model: str, messages: list, stream: bool, **kwargs):
    """
    Создает запрос к API Forefront для генерации текста.

    Args:
        model (str): Название используемой модели.
        messages (list): Список сообщений для генерации текста.
        stream (bool): Флаг, указывающий на необходимость потоковой передачи данных.
        **kwargs: Дополнительные параметры.

    Yields:
        str: Часть сгенерированного текста.

    Как работает функция:
     1. Функция принимает параметры `model` (модель), `messages` (сообщения), `stream` (потоковая передача) и `kwargs` (дополнительные аргументы).
     2. Формирует JSON-структуру `json_data`, включающую текст последнего сообщения, информацию о действии, идентификаторы, модель и сообщения (если их больше одного).
     3. Отправляет POST-запрос к API Forefront (`https://streaming.tenant-forefront-default.knative.chi.coreweave.com/free-chat`) с использованием `requests.post`, указывая `stream=True` для потоковой передачи.
     4. Итерируется по строкам ответа, полученным из `response.iter_lines()`.
     5. Для каждой строки проверяет наличие подстроки `b'delta'`.
     6. Если `b'delta'` присутствует, строка декодируется, разделяется по `data: `, извлекается JSON-содержимое и извлекается значение по ключу `delta`.
     7. Значение `delta` передается через `yield`, что позволяет получать части сгенерированного текста в потоковом режиме.

    Внутренние функции:
        Отсутствуют.
    """

```

**Как работает функция**:

```
Начало
│
└───> Формирование JSON (json_data)
│
└───> POST запрос к API Forefront (response)
│
└───> Итерация по строкам ответа (token)
│
└───> Проверка наличия 'delta' в строке
│   │
│   └───> Да: декодирование и извлечение значения delta
│   │
│   └───> Нет: пропуск
│
└───> Передача значения delta через yield
│
Конец
```

**Примеры**:

```python
# Пример использования функции _create_completion
messages = [{'role': 'user', 'content': 'Hello, how are you?'}]
for token in _create_completion(model='gpt-3.5-turbo', messages=messages, stream=True):
    print(token, end='')
```
## Переменные модуля

- `url`: URL адрес сервиса Forefront (`https://forefront.com`).
- `model`: Список поддерживаемых моделей (`['gpt-3.5-turbo']`).
- `supports_stream`: Флаг, указывающий на поддержку потоковой передачи данных (`True`).
- `needs_auth`: Флаг, указывающий на необходимость аутентификации (`False`).
- `params`: Строка, формирующая описание параметров, поддерживаемых функцией `_create_completion` для данного провайдера. Используется для логирования или отладки.