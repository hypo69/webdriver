# Документация для модуля `src.endpoints.bots.telegram`

## Обзор

Этот модуль содержит реализацию Telegram-бота, предназначенного для обработки различных команд, голосовых сообщений и файлов документов. Он обеспечивает интерактивное взаимодействие с пользователями Telegram.

## Подробнее

Модуль интегрируется с Telegram API с использованием библиотеки `python-telegram-bot`. Он включает функции для приема и обработки команд, текстовых сообщений, голосовых сообщений и файлов документов.

## Классы

### `TelegramBot`

**Описание**: Класс, представляющий Telegram-бота.

**Принцип работы**:
Класс инициализируется с использованием токена, полученного от Telegram API. Он содержит методы для регистрации обработчиков команд и сообщений, а также методы для обработки различных типов входящих данных (команд, текста, голосовых сообщений, документов).

**Атрибуты**:
- `token` (str): Токен для аутентификации бота в Telegram API.
- `application` (telegram.ext.Application): Объект приложения Telegram Bot.

**Методы**:
- `__init__(self, token: str)`: Инициализирует бота с заданным токеном и регистрирует обработчики.
- `register_handlers(self)`: Регистрирует обработчики для различных команд и типов сообщений.
- `start(self, update: Update, context: CallbackContext)`: Обрабатывает команду `/start`, отправляя приветственное сообщение пользователю.
- `help_command(self, update: Update, context: CallbackContext)`: Обрабатывает команду `/help`, предоставляя список доступных команд.
- `send_pdf(self, pdf_file: str | Path)`: Обрабатывает команду `/sendpdf`, отправляя PDF-файл пользователю.
- `handle_voice(self, update: Update, context: CallbackContext)`: Обрабатывает голосовые сообщения, загружает файл и пытается транскрибировать аудио.
- `transcribe_voice(self, file_path: Path) -> str`: Транскрибирует голосовые сообщения (в текущей версии - заглушка).
- `handle_document(self, update: Update, context: CallbackContext) -> str`: Обрабатывает файлы документов, загружает файл и читает содержимое текстового документа.
- `handle_message(self, update: Update, context: CallbackContext) -> str`: Обрабатывает текстовые сообщения, возвращая полученный текст.

## Функции

### `main`

```python
def main():
    """
    Инициализирует и запускает Telegram-бота.
    """
```

**Назначение**: Инициализация и запуск Telegram-бота.

**Как работает функция**:

1.  **Загрузка токена бота**: Функция сначала пытается получить токен бота из переменной окружения `TELEGRAM_TOKEN`. Если токен не найден, выводится сообщение об ошибке, и программа завершается.
2.  **Инициализация бота**: Создается экземпляр класса `TelegramBot` с использованием полученного токена.
3.  **Запуск бота**: Запускается процесс поллинга (опроса) обновлений от Telegram, что позволяет боту активно реагировать на входящие сообщения и команды.

```
    Получение токена из TELEGRAM_TOKEN  --→ Инициализация TelegramBot --→  Запуск процесса поллинга
```

**Примеры**:
- Запуск бота с установленным токеном:

```python
import os
os.environ['TELEGRAM_TOKEN'] = 'YOUR_TELEGRAM_TOKEN'  # Установите токен в переменной окружения
main()