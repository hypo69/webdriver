# Модуль `user_router`

## Обзор

Модуль `user_router` предназначен для обработки входящих сообщений и callback-запросов от пользователей в Telegram-боте. Он содержит обработчики для различных команд и действий пользователя, таких как старт бота, просмотр информации о магазине, просмотр профиля и истории покупок.

## Подробней

Этот модуль использует библиотеку `aiogram` для обработки сообщений и callback-запросов. Он также взаимодействует с базой данных через `UserDAO` для получения и обновления информации о пользователях и их покупках. Модуль предоставляет пользователю интерактивный интерфейс с помощью клавиатур (`main_user_kb` и `purchases_kb`).

## Классы

В данном модуле классы отсутствуют.

## Функции

### `cmd_start`

```python
async def cmd_start(message: Message, session_with_commit: AsyncSession):
    """Обработчик команды `/start`.

    Args:
        message (Message): Объект сообщения от пользователя.
        session_with_commit (AsyncSession): Асинхронная сессия SQLAlchemy для работы с базой данных.

    Returns:
        Awaitable[Message]: Отправляет приветственное сообщение с клавиатурой основных действий.

    **Как работает функция**:

    1.  Извлекает `user_id` из объекта `message`.
    2.  Ищет пользователя в базе данных по `telegram_id`.
    3.  Если пользователь найден, отправляет приветственное сообщение с клавиатурой основных действий.
    4.  Если пользователь не найден, создает новую запись в базе данных с информацией о пользователе.
    5.  Отправляет сообщение с благодарностью за регистрацию и клавиатурой основных действий.

    **Пример**:

    ```python
    # Пример вызова обработчика команды /start
    await cmd_start(message, session_with_commit)
    ```
    """
```

### `page_home`

```python
async def page_home(call: CallbackQuery):
    """Обработчик callback-запроса "home".

    Args:
        call (CallbackQuery): Объект callback-запроса от пользователя.

    Returns:
        Awaitable[Message]: Отправляет приветственное сообщение с клавиатурой основных действий.

    **Как работает функция**:

    1.  Отвечает на callback-запрос с текстом "Главная страница".
    2.  Отправляет приветственное сообщение с клавиатурой основных действий.

    **Пример**:

    ```python
    # Пример вызова обработчика callback-запроса "home"
    await page_home(call)
    ```
    """
```

### `page_about`

```python
async def page_about(call: CallbackQuery):
    """Обработчик callback-запроса "about".

    Args:
        call (CallbackQuery): Объект callback-запроса от пользователя.

    Returns:
        Awaitable[Message]: Отправляет информационное сообщение о магазине.

    **Как работает функция**:

    1.  Отвечает на callback-запрос с текстом "О магазине".
    2.  Отправляет информационное сообщение о магазине с текстом и клавиатурой.

    **Пример**:

    ```python
    # Пример вызова обработчика callback-запроса "about"
    await page_about(call)
    ```
    """
```

### `page_my_profile`

```python
async def page_about(call: CallbackQuery, session_without_commit: AsyncSession):
    """Обработчик callback-запроса "my_profile".

    Args:
        call (CallbackQuery): Объект callback-запроса от пользователя.
        session_without_commit (AsyncSession): Асинхронная сессия SQLAlchemy для работы с базой данных (без коммита).

    Returns:
        Awaitable[Message]: Отправляет информацию о профиле пользователя и предлагает просмотреть детали покупок.

    **Как работает функция**:

    1.  Отвечает на callback-запрос с текстом "Профиль".
    2.  Получает статистику покупок пользователя из базы данных.
    3.  Формирует сообщение в зависимости от наличия покупок:
        *   Если покупок нет, отправляет сообщение об отсутствии покупок и предлагает открыть каталог.
        *   Если покупки есть, отправляет сообщение с количеством покупок и общей суммой, а также предлагает просмотреть детали покупок.

    **Пример**:

    ```python
    # Пример вызова обработчика callback-запроса "my_profile"
    await page_about(call, session_without_commit)
    ```
    """
```

### `page_user_purchases`

```python
async def page_user_purchases(call: CallbackQuery, session_without_commit: AsyncSession):
    """Обработчик callback-запроса "purchases".

    Args:
        call (CallbackQuery): Объект callback-запроса от пользователя.
        session_without_commit (AsyncSession): Асинхронная сессия SQLAlchemy для работы с базой данных (без коммита).

    Returns:
        Awaitable[Message]: Отправляет информацию о покупках пользователя.

    **Как работает функция**:

    1.  Отвечает на callback-запрос с текстом "Мои покупки".
    2.  Пытается удалить предыдущее сообщение пользователя (если оно есть).
    3.  Получает список покупок пользователя из базы данных.
    4.  Если покупок нет, отправляет сообщение об отсутствии покупок и предлагает открыть каталог.
    5.  Если покупки есть, для каждой покупки отправляет информацию о товаре, включая название, описание, цену и содержимое (текст или файл).
    6.  Отправляет сообщение с благодарностью за доверие и предлагает вернуться на главную страницу.

    **Пример**:

    ```python
    # Пример вызова обработчика callback-запроса "purchases"
    await page_user_purchases(call, session_without_commit)
    ```
    """