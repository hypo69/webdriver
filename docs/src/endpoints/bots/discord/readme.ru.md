# Документация для модуля Discord-бота

## Обзор

Этот документ предоставляет подробное описание функциональности модуля Discord-бота, который является частью проекта `hypotez`. Бот предназначен для выполнения различных задач, таких как управление моделями машинного обучения, обработка аудио и взаимодействие с пользователями через текстовые и голосовые каналы в Discord.

## Подробнее

Модуль Discord-бота обеспечивает интерактивное взаимодействие с пользователями, позволяя им отправлять команды, загружать данные для обучения моделей, получать инструкции и отправлять отзывы. Бот использует различные библиотеки, такие как `discord.py`, `speech_recognition`, `pydub` и `gtts`, для обработки сообщений, распознавания речи и преобразования текста в речь.

## Функции и команды бота

### Основные функции и команды бота:

1.  **Инициализация бота:**
    -   Бот инициализируется с префиксом команд `!` и включает необходимые интенты (интенты — это разрешения на доступ к определенным событиям Discord).

2.  **Команды:**
    -   `!hi`: Отправляет приветственное сообщение.
    -   `!join`: Подключает бота к голосовому каналу, в котором находится пользователь.
    -   `!leave`: Отключает бота от голосового канала.
    -   `!train`: Обучает модель на предоставленных данных. Можно передать данные в виде файла или текста.
    -   `!test`: Тестирует модель на предоставленных данных.
    -   `!archive`: Архивирует файлы в указанной директории.
    -   `!select_dataset`: Выбирает датасет для обучения модели.
    -   `!instruction`: Отправляет инструкции из внешнего файла.
    -   `!correct`: Позволяет пользователю исправить предыдущее сообщение бота.
    -   `!feedback`: Позволяет пользователю отправить обратную связь о работе бота.
    -   `!getfile`: Отправляет файл из указанного пути.

3.  **Обработка сообщений:**
    -   Бот обрабатывает входящие сообщения, игнорируя свои собственные сообщения.
    -   Если пользователь отправляет аудиофайл, бот распознает речь в аудио и отправляет текст в ответ.
    -   Если пользователь находится в голосовом канале, бот преобразует текст в речь и воспроизводит его в голосовом канале.

4.  **Распознавание речи:**
    -   Функция `recognizer` скачивает аудиофайл, конвертирует его в формат WAV и распознает речь с помощью Google Speech Recognition.

5.  **Текст в речь:**
    -   Функция `text_to_speech_and_play` преобразует текст в речь с помощью библиотеки `gTTS` и воспроизводит его в голосовом канале.

6.  **Логирование:**
    -   Используется модуль `logger` для логирования событий и ошибок.

### Основные модули и библиотеки:

-   `discord.py`: Основная библиотека для создания Discord-ботов.
-   `speech_recognition`: Для распознавания речи.
-   `pydub`: Для конвертации аудиофайлов.
-   `gtts`: Для преобразования текста в речь.
-   `requests`: Для скачивания файлов.
-   `pathlib`: Для работы с путями файлов.
-   `tempfile`: Для создания временных файлов.
-   `asyncio`: Для асинхронного выполнения задач.

### Запуск бота:

-   Бот запускается с использованием токена, который хранится в переменной `gs.credentials.discord.bot_token`.

## Заключение:

Этот бот предназначен для интерактивного взаимодействия с пользователями в Discord, включая обработку голосовых команд, обучение и тестирование модели машинного обучения, а также предоставление инструкций и обратной связи.