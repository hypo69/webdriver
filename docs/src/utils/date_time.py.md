# Модуль для проверки времени и ожидания ввода с таймаутом

## Обзор

Модуль содержит класс `TimeoutCheck`, который используется для проверки, находится ли текущее время в заданном интервале, а также для ожидания ввода от пользователя с использованием таймаута. Это полезно для выполнения операций, которые должны происходить только в определенные периоды времени, или для предотвращения блокировки программы при ожидании ввода.

## Подробнее

Модуль предоставляет класс `TimeoutCheck` с методами для проверки временных интервалов и ожидания ввода с таймаутом. Он использует модуль `threading` для параллельного выполнения задач, таких как проверка времени и ожидание ввода. Это позволяет избежать блокировки основного потока программы.

## Классы

### `TimeoutCheck`

**Описание**: Класс для проверки временных интервалов и ожидания ввода с таймаутом.

**Принцип работы**:
Класс `TimeoutCheck` инициализируется без параметров. Он содержит методы для проверки, находится ли текущее время в заданном интервале, и для ожидания ввода от пользователя с использованием таймаута. Класс использует модуль `threading` для параллельного выполнения задач, что позволяет избежать блокировки основного потока программы.

**Атрибуты**:
- `result` (bool | None): Результат проверки временного интервала.
- `user_input` (str | None): Ввод пользователя.

**Методы**:
- `interval(start: time = time(23, 0), end: time = time(6, 0)) -> bool`: Проверяет, находится ли текущее время в заданном интервале.
- `interval_with_timeout(timeout: int = 5, start: time = time(23, 0), end: time = time(6, 0)) -> bool`: Проверяет, находится ли текущее время в заданном интервале с таймаутом.
- `get_input() -> None`: Запрашивает ввод от пользователя.
- `input_with_timeout(timeout: int = 5) -> str | None`: Ожидает ввод с таймаутом.

## Функции

### `interval`

```python
def interval(self, start: time = time(23, 0), end: time = time(6, 0)) -> bool:
    """ Проверяет, находится ли текущее время в заданном интервале.

    Args:
        start (time): Начало интервала (по умолчанию 23:00).
        end (time): Конец интервала (по умолчанию 06:00).

    Returns:
        bool: True, если текущее время находится в интервале, False в противном случае.
    """
```

**Назначение**: Проверяет, находится ли текущее время в заданном интервале.

**Параметры**:
- `start` (time): Время начала интервала (по умолчанию 23:00).
- `end` (time): Время окончания интервала (по умолчанию 06:00).

**Возвращает**:
- `bool`: `True`, если текущее время находится в интервале, `False` в противном случае.

**Как работает функция**:

1. Функция получает текущее время.
2. Если время начала интервала меньше времени окончания интервала, функция проверяет, находится ли текущее время между временем начала и временем окончания интервала.
3. Если время начала интервала больше времени окончания интервала, функция проверяет, находится ли текущее время после времени начала интервала или до времени окончания интервала (для интервалов, пересекающих полночь).
4. Результат проверки сохраняется в атрибуте `self.result`.

```
Текущее время
    │
    │ Получение текущего времени
    │
    ▼
Начало < Конец?
    ├───> Да: Проверка: Начало <= Текущее время <= Конец
    │       │
    │       └───> Результат проверки
    │
    └───> Нет: Проверка: Текущее время >= Начало ИЛИ Текущее время <= Конец
            │
            └───> Результат проверки
```

**Примеры**:

```python
from datetime import time
timeout_check = TimeoutCheck()

# Проверка интервала с 23:00 до 06:00
result = timeout_check.interval()
print(f"Текущее время в интервале 23:00 - 06:00: {result}")

# Проверка интервала с 08:00 до 17:00
result = timeout_check.interval(start=time(8, 0), end=time(17, 0))
print(f"Текущее время в интервале 08:00 - 17:00: {result}")
```

### `interval_with_timeout`

```python
def interval_with_timeout(self, timeout: int = 5, start: time = time(23, 0), end: time = time(6, 0)) -> bool:
    """ Проверяет, находится ли текущее время в заданном интервале с таймаутом.

    Args:
        timeout (int): Время в секундах для ожидания проверки интервала.
        start (time): Начало интервала (по умолчанию 23:00).
        end (time): Конец интервала (по умолчанию 06:00).

    Returns:
        bool: True, если текущее время находится в интервале и ответ получен в течение таймаута, False, если нет или произошел таймаут.
    """
```

**Назначение**: Проверяет, находится ли текущее время в заданном интервале с таймаутом.

**Параметры**:
- `timeout` (int): Время в секундах для ожидания проверки интервала (по умолчанию 5).
- `start` (time): Время начала интервала (по умолчанию 23:00).
- `end` (time): Время окончания интервала (по умолчанию 06:00).

**Возвращает**:
- `bool`: `True`, если текущее время находится в интервале и ответ получен в течение таймаута, `False`, если нет или произошел таймаут.

**Как работает функция**:

1. Функция создает новый поток, который выполняет проверку интервала с помощью метода `interval`.
2. Функция запускает поток и ожидает его завершения в течение заданного таймаута.
3. Если поток завершается в течение таймаута, функция возвращает результат проверки интервала, сохраненный в атрибуте `self.result`.
4. Если поток не завершается в течение таймаута, функция выводит сообщение о таймауте и возвращает `False`.

```
Начало
    │
    │ Создание и запуск потока для проверки интервала
    │
    ▼
Ожидание завершения потока с таймаутом
    │
    ├───> Поток завершился: Получение результата проверки интервала
    │       │
    │       └───> Возврат результата
    │
    └───> Таймаут: Вывод сообщения о таймауте
            │
            └───> Возврат False
```

**Примеры**:

```python
from datetime import time
timeout_check = TimeoutCheck()

# Проверка интервала с 23:00 до 06:00 с таймаутом 5 секунд
result = timeout_check.interval_with_timeout(timeout=5)
print(f"Текущее время в интервале 23:00 - 06:00 (таймаут 5 секунд): {result}")

# Проверка интервала с 08:00 до 17:00 с таймаутом 2 секунды
result = timeout_check.interval_with_timeout(timeout=2, start=time(8, 0), end=time(17, 0))
print(f"Текущее время в интервале 08:00 - 17:00 (таймаут 2 секунды): {result}")
```

### `get_input`

```python
def get_input(self) -> None:
    """ Запрашивает ввод от пользователя."""
```

**Назначение**: Запрашивает ввод от пользователя.

**Как работает функция**:

1.  Функция выводит приглашение "U:> " в консоль и ожидает ввода от пользователя.
2.  Введенные пользователем данные сохраняются в атрибуте `self.user_input`.

### `input_with_timeout`

```python
def input_with_timeout(self, timeout: int = 5) -> str | None:
    """ Ожидает ввод с тайм-аутом.

    Args:
        timeout (int): Время ожидания ввода в секундах.

    Returns:
        str | None: Введенные данные или None, если был тайм-аут.
    """
```

**Назначение**: Ожидает ввод от пользователя с таймаутом.

**Параметры**:
- `timeout` (int): Время ожидания ввода в секундах (по умолчанию 5).

**Возвращает**:
- `str | None`: Введенные данные или `None`, если произошел таймаут.

**Как работает функция**:

1. Функция создает новый поток, который выполняет запрос ввода от пользователя с помощью метода `get_input`.
2. Функция запускает поток и ожидает его завершения в течение заданного таймаута.
3. Если поток завершается в течение таймаута, функция возвращает введенные пользователем данные, сохраненные в атрибуте `self.user_input`.
4. Если поток не завершается в течение таймаута, функция выводит сообщение о таймауте и возвращает `None`.

```
Начало
    │
    │ Создание и запуск потока для запроса ввода
    │
    ▼
Ожидание завершения потока с таймаутом
    │
    ├───> Поток завершился: Получение введенных данных
    │       │
    │       └───> Возврат введенных данных
    │
    └───> Таймаут: Вывод сообщения о таймауте
            │
            └───> Возврат None
```

**Примеры**:

```python
timeout_check = TimeoutCheck()

# Ожидание ввода с таймаутом 5 секунд
user_input = timeout_check.input_with_timeout(timeout=5)
if user_input:
    print(f"Введенные данные: {user_input}")
else:
    print("Таймаут ввода")

# Ожидание ввода с таймаутом 2 секунды
user_input = timeout_check.input_with_timeout(timeout=2)
if user_input:
    print(f"Введенные данные: {user_input}")
else:
    print("Таймаут ввода")