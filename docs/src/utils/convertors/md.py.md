# Модуль `md2dict`

## Обзор

Модуль `md2dict` предназначен для конвертации строк в формате Markdown в структурированные словари. Он включает функциональность для преобразования Markdown в HTML и последующего извлечения информации для организации её в словарь.

## Подробней

Модуль предоставляет функции для преобразования текста в формате Markdown в HTML и структурированный словарь. Он использует библиотеку `markdown2` для конвертации Markdown в HTML и регулярные выражения для парсинга HTML и извлечения информации. Этот модуль полезен для обработки текстовых документов в формате Markdown, например, для анализа структуры документов или извлечения данных.

## Функции

### `md2html`

```python
def md2html(md_string: str, extras: List[str] = None) -> str:
    """
    Конвертирует строку Markdown в HTML.

    Args:
        md_string (str): Строка Markdown для конвертации.
        extras (list, optional): Список расширений markdown2. Defaults to None.

    Returns:
        str: HTML-представление Markdown.
    """
```

**Назначение**: Преобразует строку, содержащую текст в формате Markdown, в HTML.

**Параметры**:
- `md_string` (str): Строка в формате Markdown, которую необходимо преобразовать в HTML.
- `extras` (List[str], optional): Список расширений для библиотеки `markdown2`. По умолчанию `None`.

**Возвращает**:
- `str`: HTML-представление входной Markdown-строки.

**Вызывает исключения**:
- `Exception`: Логируется ошибка при преобразовании Markdown в HTML.

**Как работает функция**:
1. Пытается преобразовать входную Markdown-строку в HTML с использованием библиотеки `markdown2`.
2. Если указаны расширения (`extras`), они передаются в функцию `markdown2.markdown`.
3. В случае возникновения ошибки, она логируется, и возвращается пустая строка.

```
   A (Принятие строки Markdown и списка расширений)
   |
   -- B (Преобразование Markdown в HTML)
   |
   C (Возврат HTML)
```

**Примеры**:

```python
from src.utils.convertors.md import md2html

markdown_text = "# Заголовок 1\nЭто параграф."
html_text = md2html(markdown_text)
print(html_text)  # Вывод: <h1 id="заголовок-1">Заголовок 1</h1>\n\n<p>Это параграф.</p>
```

### `md2dict`

```python
def md2dict(md_string: str, extras: List[str] = None) -> Dict[str, list[str]]:
    """
    Конвертирует строку Markdown в структурированный словарь.

    Args:
        md_string (str): Строка Markdown для конвертации.
        extras (list, optional): Список расширений markdown2 для md2html. Defaults to None.

    Returns:
         Dict[str, list[str]]: Структурированное представление Markdown содержимого.
    """
```

**Назначение**: Преобразует строку в формате Markdown в структурированный словарь, где ключами являются заголовки разделов, а значениями — списки строк, составляющих содержание этих разделов.

**Параметры**:
- `md_string` (str): Строка в формате Markdown, которую необходимо преобразовать в словарь.
- `extras` (List[str], optional): Список расширений для библиотеки `markdown2`, используемый в функции `md2html`. По умолчанию `None`.

**Возвращает**:
- `Dict[str, list[str]]`: Словарь, представляющий структурированное содержание Markdown. Ключи словаря — заголовки разделов, значения — списки строк, относящихся к этим разделам.

**Вызывает исключения**:
- `Exception`: Логируется ошибка при парсинге Markdown в структурированный словарь.

**Как работает функция**:
1. Преобразует входную Markdown-строку в HTML с использованием функции `md2html`.
2. Инициализирует пустой словарь `sections` для хранения структуры документа.
3. Разбивает HTML-код на строки и итерируется по ним.
4. Если строка начинается с тега заголовка (`<h`), извлекает уровень заголовка и текст заголовка.
5. Если уровень заголовка равен 1, устанавливает текущий раздел (`current_section`) и создает новый список в словаре `sections` для этого раздела.
6. Если уровень заголовка больше 1, добавляет текст заголовка в список текущего раздела.
7. Если строка содержит текст и текущий раздел установлен, очищает текст от HTML-тегов и добавляет его в список текущего раздела.
8. В случае возникновения ошибки логирует её и возвращает пустой словарь.

```
    A (Принятие строки Markdown и списка расширений)
    |
    -- B (Преобразование Markdown в HTML)
    |
    -- C (Разбиение HTML на строки)
    |
    -- D (Поиск заголовков и текста)
    |
    -- E (Формирование структуры словаря)
    |
    F (Возврат словаря)
```

**Примеры**:

```python
from src.utils.convertors.md import md2dict

markdown_text = """
# Заголовок 1
Это параграф.

## Заголовок 2
Это еще один параграф.
"""
result_dict = md2dict(markdown_text)
print(result_dict)
# Вывод:
# {
#     "Заголовок 1": ["Это параграф."],
#     "Заголовок 2": ["Это еще один параграф."]
# }