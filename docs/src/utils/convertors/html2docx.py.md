# Модуль для конвертации HTML в DOCX с использованием LibreOffice
=============================================================

Модуль содержит функцию :func:`html_to_docx`, которая преобразует HTML-файл в документ Word (.docx) с помощью LibreOffice.

## Обзор

Этот модуль предоставляет функцию для конвертации HTML-файлов в формат DOCX с использованием LibreOffice. Он предназначен для автоматизации процесса преобразования HTML-контента в редактируемые документы Word. Модуль использует подпроцессы для вызова LibreOffice в режиме headless, что позволяет выполнять преобразование без графического интерфейса.

## Подробней

Модуль `html2docx` предоставляет функцию `html_to_docx`, которая принимает путь к HTML-файлу и путь для сохранения DOCX-файла. Функция использует LibreOffice для выполнения преобразования. Важно, чтобы LibreOffice был установлен и доступен в системной переменной PATH. В случае возникновения ошибок во время преобразования, они логируются с использованием модуля `logger`.

## Функции

### `html_to_docx`

```python
def html_to_docx(html_file: str, output_docx: Path | str) -> bool:
    """Converts an HTML file to a Word document using LibreOffice.

    Args:
        html_file (str): Path to the input HTML file as a string.
        output_docx (Path | str): Path to the output DOCX file.

    Returns:
        bool: True if conversion is successful, False otherwise.
    """
```

**Назначение**: Преобразует HTML-файл в документ Word (.docx) с использованием LibreOffice.

**Параметры**:

- `html_file` (str): Путь к входному HTML-файлу.
- `output_docx` (Path | str): Путь к выходному DOCX-файлу.

**Возвращает**:

- `bool`: `True`, если преобразование выполнено успешно, `False` в противном случае.

**Вызывает исключения**:

- `subprocess.CalledProcessError`: Если LibreOffice не смог выполнить преобразование.
- `FileNotFoundError`: Если исполняемый файл LibreOffice (soffice) не найден.
- `Exception`: Если произошла непредвиденная ошибка во время преобразования.

**Как работает функция**:

1. **Проверка наличия HTML-файла**: Проверяет, существует ли HTML-файл по указанному пути. Если файл не найден, функция логирует ошибку и возвращает `False`.
2. **Проверка наличия выходной директории**: Проверяет, существует ли директория для сохранения выходного DOCX-файла. Если директория не существует, она создается.
3. **Формирование команды LibreOffice**: Формирует команду для вызова LibreOffice в режиме headless, указывая входной HTML-файл, формат преобразования (docx:HTML) и выходную директорию.
4. **Выполнение команды LibreOffice**: Выполняет команду LibreOffice с использованием модуля `subprocess`. Если команда завершается с ошибкой, функция логирует ошибку и возвращает `False`.
5. **Проверка ошибок вывода**: Проверяет наличие ошибок в стандартном потоке ошибок процесса. В случае ошибок логирует их
6. **Обработка исключений**: Обрабатывает исключения, которые могут возникнуть во время выполнения команды, такие как `subprocess.CalledProcessError` (ошибка выполнения LibreOffice), `FileNotFoundError` (LibreOffice не найден) и `Exception` (непредвиденная ошибка). В случае возникновения исключения, функция логирует ошибку и возвращает `False`.

**ASCII Flowchart**:

```
A: Проверка наличия HTML-файла
|
B: Проверка наличия выходной директории
|
C: Формирование команды LibreOffice
|
D: Выполнение команды LibreOffice
|
E: Проверка ошибок вывода
|
F: Обработка исключений
```

**Примеры**:

```python
from pathlib import Path

html_file = "template.html"  # Замените на ваш HTML-файл
output_docx = Path("output_libreoffice.docx")  # Замените на желаемый выходной файл

if html_to_docx(html_file, output_docx):
    print(f"Успешно преобразован {html_file} в {output_docx} с использованием LibreOffice!")
else:
    print(f"Не удалось преобразовать {html_file} в {output_docx} с использованием LibreOffice.")